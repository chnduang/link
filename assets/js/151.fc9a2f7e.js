(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{442:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"react-hooks-å¤§ä¸²è®²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-hooks-å¤§ä¸²è®²"}},[t._v("#")]),t._v(" react-hooks å¤§ä¸²è®²")]),t._v(" "),s("h1",{attrs:{id:"ä¸€-å‰è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€-å‰è¨€"}},[t._v("#")]),t._v(" ä¸€ å‰è¨€")]),t._v(" "),s("p",[t._v("ä¹‹å‰çš„ä¸¤ç¯‡æ–‡ç« ï¼Œåˆ†åˆ«ä»‹ç»äº†"),s("code",[t._v("react-hooks")]),t._v("å¦‚ä½•ä½¿ç”¨ï¼Œä»¥åŠè‡ªå®šä¹‰"),s("code",[t._v("hooks")]),t._v("è®¾è®¡æ¨¡å¼åŠå…¶å®æˆ˜ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»"),s("code",[t._v("react-hooks")]),t._v("èµ·æºï¼ŒåŸç†ï¼Œæºç è§’åº¦ï¼Œå¼€å§‹å‰–æ"),s("code",[t._v("react-hooks")]),t._v("è¿è¡Œæœºåˆ¶å’Œå†…éƒ¨åŸç†ï¼Œç›¸ä¿¡è¿™ç¯‡æ–‡ç« è¿‡åï¼Œå¯¹äºé¢è¯•çš„æ—¶å€™é‚£äº›"),s("code",[t._v("hooks")]),t._v("é—®é¢˜ï¼Œä¹Ÿå°±è¿åˆƒè€Œè§£äº†ã€‚å®é™…"),s("code",[t._v("react-hooks")]),t._v("ä¹Ÿå¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ä»¥ç†è§£ï¼Œå¬èµ·æ¥å¾ˆ"),s("code",[t._v("cool")]),t._v("ï¼Œå®é™…å°±æ˜¯å‡½æ•°ç»„ä»¶"),s("strong",[t._v("è§£å†³æ²¡æœ‰"),s("code",[t._v("state")]),t._v("ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œé€»è¾‘ä¸èƒ½å¤ç”¨")]),t._v("çš„ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚")])]),t._v(" "),s("p",[t._v("è€è§„çŸ©,ğŸ¤”ï¸ğŸ¤”ï¸ğŸ¤”ï¸æˆ‘ä»¬å¸¦ç€ç–‘é—®å¼€å§‹ä»Šå¤©çš„æ¢è®¨("),s("strong",[t._v("èƒ½å›ç­”ä¸Šå‡ ä¸ªï¼Œè‡ªå·±å¯ä»¥å°è¯•ä¸€ä¸‹ï¼ŒæŒæ¡ç¨‹åº¦")]),t._v(")ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("1 åœ¨æ— çŠ¶æ€ç»„ä»¶æ¯ä¸€æ¬¡å‡½æ•°ä¸Šä¸‹æ–‡æ‰§è¡Œçš„æ—¶å€™ï¼Œ"),s("code",[t._v("react")]),t._v("ç”¨ä»€ä¹ˆæ–¹å¼è®°å½•äº†"),s("code",[t._v("hooks")]),t._v("çš„çŠ¶æ€ï¼Ÿ")]),t._v(" "),s("li",[t._v("2 å¤šä¸ª"),s("code",[t._v("react-hooks")]),t._v("ç”¨ä»€ä¹ˆæ¥è®°å½•æ¯ä¸€ä¸ª"),s("code",[t._v("hooks")]),t._v("çš„é¡ºåºçš„ ï¼Ÿæ¢ä¸ªé—®æ³•ï¼ä¸ºä»€ä¹ˆä¸èƒ½æ¡ä»¶è¯­å¥ä¸­ï¼Œå£°æ˜"),s("code",[t._v("hooks")]),t._v("? "),s("code",[t._v("hooks")]),t._v("å£°æ˜ä¸ºä»€ä¹ˆåœ¨ç»„ä»¶çš„æœ€é¡¶éƒ¨ï¼Ÿ")]),t._v(" "),s("li",[t._v("3 "),s("code",[t._v("function")]),t._v("å‡½æ•°ç»„ä»¶ä¸­çš„"),s("code",[t._v("useState")]),t._v("ï¼Œå’Œ "),s("code",[t._v("class")]),t._v("ç±»ç»„ä»¶ "),s("code",[t._v("setState")]),t._v("æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),t._v(" "),s("li",[t._v("4 "),s("code",[t._v("react")]),t._v(" æ˜¯æ€ä¹ˆæ•è·åˆ°"),s("code",[t._v("hooks")]),t._v("çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ˜¯åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨çš„ï¼Ÿ")]),t._v(" "),s("li",[t._v("5 "),s("code",[t._v("useEffect")]),t._v(","),s("code",[t._v("useMemo")]),t._v(" ä¸­ï¼Œä¸ºä»€ä¹ˆ"),s("code",[t._v("useRef")]),t._v("ä¸éœ€è¦ä¾èµ–æ³¨å…¥ï¼Œå°±èƒ½è®¿é—®åˆ°æœ€æ–°çš„æ”¹å˜å€¼ï¼Ÿ")]),t._v(" "),s("li",[t._v("6 "),s("code",[t._v("useMemo")]),t._v("æ˜¯æ€ä¹ˆå¯¹å€¼åšç¼“å­˜çš„ï¼Ÿå¦‚ä½•åº”ç”¨å®ƒä¼˜åŒ–æ€§èƒ½ï¼Ÿ")]),t._v(" "),s("li",[t._v("7 ä¸ºä»€ä¹ˆä¸¤æ¬¡ä¼ å…¥"),s("code",[t._v("useState")]),t._v("çš„å€¼ç›¸åŒï¼Œå‡½æ•°ç»„ä»¶ä¸æ›´æ–°?")]),t._v(" "),s("li",[t._v("...")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9bIKZo5jRmpYBNktnojCSRQwIsGTkrxp8aCIic4o9BjcqQiaasfQ1JoCQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å¦‚æœä½ è®¤çœŸè¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œè¿™äº›é—®é¢˜å…¨ä¼šè¿åˆƒè€Œè§£ã€‚")]),t._v(" "),s("h2",{attrs:{id:"functionç»„ä»¶å’Œclassç»„ä»¶æœ¬è´¨çš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#functionç»„ä»¶å’Œclassç»„ä»¶æœ¬è´¨çš„åŒºåˆ«"}},[t._v("#")]),t._v(" functionç»„ä»¶å’Œclassç»„ä»¶æœ¬è´¨çš„åŒºåˆ«")]),t._v(" "),s("p",[t._v("åœ¨è§£é‡Š"),s("code",[t._v("react-hooks")]),t._v("åŸç†çš„ä¹‹å‰ï¼Œæˆ‘ä»¬è¦åŠ æ·±ç†è§£ä¸€ä¸‹ï¼Œ "),s("strong",[t._v("å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«")]),t._v("ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬å…ˆçœ‹ ä¸¤ä¸ªä»£ç ç‰‡æ®µã€‚")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Index")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("any"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handerClick")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n               console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handerClick "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("num"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æ‰“å°ç»“æœï¼Ÿ")]),t._v(" "),s("p",[t._v("å†æ¥çœ‹çœ‹å‡½æ•°ç»„ä»¶ä¸­ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" num "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("setNumber "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handerClick")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNumber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" handerClick "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" num "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æ‰“å°ç»“æœï¼Ÿ")]),t._v(" "),s("p",[t._v("------------å…¬å¸ƒç­”æ¡ˆ-------------")]),t._v(" "),s("p",[t._v("åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ğŸŒ°æ‰“å°ç»“æœï¼š1 2 3 4 5")]),t._v(" "),s("p",[t._v("åœ¨ç¬¬äºŒä¸ªä¾‹å­ğŸŒ°æ‰“å°ç»“æœï¼š0 0 0 0 0")]),t._v(" "),s("p",[t._v("è¿™ä¸ªé—®é¢˜å®é™…å¾ˆè’™äººï¼Œæˆ‘ä»¬æ¥ä¸€èµ·åˆ†æä¸€ä¸‹,ç¬¬ä¸€ä¸ªç±»ç»„ä»¶ä¸­ï¼Œç”±äºæ‰§è¡Œä¸Š"),s("code",[t._v("setState")]),t._v("æ²¡æœ‰åœ¨"),s("code",[t._v("react")]),t._v("æ­£å¸¸çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸Šæ‰§è¡Œï¼Œè€Œæ˜¯"),s("code",[t._v("setTimeout")]),t._v("ä¸­æ‰§è¡Œçš„ï¼Œ"),s("strong",[t._v("æ‰¹é‡æ›´æ–°")]),t._v("æ¡ä»¶è¢«ç ´åã€‚åŸç†è¿™é‡Œæˆ‘å°±ä¸è®²äº†,æ‰€ä»¥å¯ä»¥ç›´æ¥è·å–åˆ°å˜åŒ–åçš„"),s("code",[t._v("state")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("ä½†æ˜¯åœ¨æ— çŠ¶æ€ç»„ä»¶ä¸­ï¼Œä¼¼ä¹æ²¡æœ‰ç”Ÿæ•ˆã€‚åŸå› å¾ˆç®€å•ï¼Œåœ¨"),s("code",[t._v("class")]),t._v("çŠ¶æ€ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå®ä¾‹åŒ–çš„"),s("code",[t._v("class")]),t._v("ï¼Œå»ç»´æŠ¤ç»„ä»¶ä¸­çš„å„ç§çŠ¶æ€ï¼›ä½†æ˜¯åœ¨"),s("code",[t._v("function")]),t._v("ç»„ä»¶ä¸­ï¼Œæ²¡æœ‰ä¸€ä¸ªçŠ¶æ€å»ä¿å­˜è¿™äº›ä¿¡æ¯ï¼Œæ¯ä¸€æ¬¡å‡½æ•°ä¸Šä¸‹æ–‡æ‰§è¡Œï¼Œæ‰€æœ‰å˜é‡ï¼Œå¸¸é‡éƒ½é‡æ–°å£°æ˜ï¼Œæ‰§è¡Œå®Œæ¯•ï¼Œå†è¢«åƒåœ¾æœºåˆ¶å›æ”¶ã€‚æ‰€ä»¥å¦‚ä¸Šï¼Œæ— è®º"),s("code",[t._v("setTimeout")]),t._v("æ‰§è¡Œå¤šå°‘æ¬¡ï¼Œéƒ½æ˜¯åœ¨å½“å‰å‡½æ•°ä¸Šä¸‹æ–‡æ‰§è¡Œ,æ­¤æ—¶"),s("code",[t._v("num = 0")]),t._v("ä¸ä¼šå˜ï¼Œä¹‹å"),s("code",[t._v("setNumber")]),t._v("æ‰§è¡Œï¼Œå‡½æ•°ç»„ä»¶é‡æ–°æ‰§è¡Œä¹‹åï¼Œ"),s("code",[t._v("num")]),t._v("æ‰å˜åŒ–ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥ï¼Œ å¯¹äº"),s("code",[t._v("class")]),t._v("ç»„ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå®ä¾‹ä¸­ä¿å­˜äº†ç»„ä»¶çš„"),s("code",[t._v("state")]),t._v("ç­‰çŠ¶æ€ã€‚å¯¹äºæ¯ä¸€æ¬¡æ›´æ–°åªéœ€è¦è°ƒç”¨"),s("code",[t._v("render")]),t._v("æ–¹æ³•å°±å¯ä»¥ã€‚ä½†æ˜¯åœ¨"),s("code",[t._v("function")]),t._v("ç»„ä»¶ä¸­ï¼Œæ¯ä¸€æ¬¡æ›´æ–°éƒ½æ˜¯ä¸€æ¬¡æ–°çš„å‡½æ•°æ‰§è¡Œ,ä¸ºäº†ä¿å­˜ä¸€äº›çŠ¶æ€,æ‰§è¡Œä¸€äº›å‰¯ä½œç”¨é’©å­,"),s("code",[t._v("react-hooks")]),t._v("åº”è¿è€Œç”Ÿï¼Œå»å¸®åŠ©è®°å½•ç»„ä»¶çš„çŠ¶æ€ï¼Œå¤„ç†ä¸€äº›é¢å¤–çš„å‰¯ä½œç”¨ã€‚")]),t._v(" "),s("h1",{attrs:{id:"ä¸€-åˆè¯†-æ­å¼€hooksçš„é¢çº±"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€-åˆè¯†-æ­å¼€hooksçš„é¢çº±"}},[t._v("#")]),t._v(" ä¸€ åˆè¯†ï¼šæ­å¼€hooksçš„é¢çº±")]),t._v(" "),s("h2",{attrs:{id:"_1-å½“æˆ‘ä»¬å¼•å…¥hooksæ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-å½“æˆ‘ä»¬å¼•å…¥hooksæ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆ"}},[t._v("#")]),t._v(" 1 å½“æˆ‘ä»¬å¼•å…¥hooksæ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬ä»å¼•å…¥ "),s("code",[t._v("hooks")]),t._v("å¼€å§‹ï¼Œä»¥"),s("code",[t._v("useState")]),t._v("ä¸ºä¾‹å­ï¼Œå½“æˆ‘ä»¬ä»é¡¹ç›®ä¸­è¿™ä¹ˆå†™ï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("import { useState } from 'react'\n")])])]),s("p",[t._v("äºæ˜¯ä¹æˆ‘ä»¬å»æ‰¾"),s("code",[t._v("useState")]),t._v(",çœ‹çœ‹å®ƒåˆ°åº•æ˜¯å“ªè·¯ç¥ä»™ï¼Ÿ")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("react/src/ReactHooks.js\n")])])]),s("p",[s("strong",[t._v("useState")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dispatcher "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolveDispatcher")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" dispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("initialState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("useState()")]),t._v(" çš„æ‰§è¡Œç­‰äº "),s("code",[t._v("dispatcher.useState(initialState)")]),t._v(" è¿™é‡Œé¢å¼•å…¥äº†ä¸€ä¸ª"),s("code",[t._v("dispatcher")]),t._v("ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹"),s("code",[t._v("resolveDispatcher")]),t._v("åšäº†äº›ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("resolveDispatcher")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolveDispatcher")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dispatcher "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReactCurrentDispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" dispatcher\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("ReactCurrentDispatcher")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("react/src/ReactCurrentDispatcher.js\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ReactCurrentDispatcher "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("current")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("æˆ‘ä»¬çœ‹åˆ°"),s("code",[t._v("ReactCurrentDispatcher.current")]),t._v("åˆå§‹åŒ–çš„æ—¶å€™ä¸º"),s("code",[t._v("null")]),t._v("ï¼Œç„¶åå°±æ²¡ä»»ä½•ä¸‹æ–‡äº†ã€‚æˆ‘ä»¬æš‚ä¸”åªèƒ½æŠŠ**"),s("code",[t._v("ReactCurrentDispatcher")]),t._v("**è®°ä¸‹æ¥ã€‚çœ‹çœ‹"),s("code",[t._v("ReactCurrentDispatcher")]),t._v("ä»€ä¹ˆæ—¶å€™ç”¨åˆ°çš„ ï¼Ÿ")]),t._v(" "),s("h2",{attrs:{id:"_2-å¼€å·¥é€ ç‰©-ä»æ— çŠ¶æ€ç»„ä»¶çš„å‡½æ•°æ‰§è¡Œè¯´èµ·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¼€å·¥é€ ç‰©-ä»æ— çŠ¶æ€ç»„ä»¶çš„å‡½æ•°æ‰§è¡Œè¯´èµ·"}},[t._v("#")]),t._v(" 2 å¼€å·¥é€ ç‰©ï¼Œä»æ— çŠ¶æ€ç»„ä»¶çš„å‡½æ•°æ‰§è¡Œè¯´èµ·")]),t._v(" "),s("p",[t._v("æƒ³è¦å½»åº•å¼„æ˜ç™½"),s("code",[t._v("hooks")]),t._v("ï¼Œå°±è¦ä»å…¶æ ¹æºå¼€å§‹ï¼Œä¸Šè¿°æˆ‘ä»¬åœ¨å¼•å…¥"),s("code",[t._v("hooks")]),t._v("çš„æ—¶å€™ï¼Œæœ€åä»¥ä¸€ä¸ª"),s("code",[t._v("ReactCurrentDispatcher")]),t._v("è‰è‰æ”¶å°¾ï¼Œçº¿ç´¢å…¨éƒ¨æ–­äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬åªèƒ½ä»å‡½æ•°ç»„ä»¶æ‰§è¡Œå¼€å§‹ã€‚")]),t._v(" "),s("h3",{attrs:{id:"renderwithhooks-æ‰§è¡Œå‡½æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#renderwithhooks-æ‰§è¡Œå‡½æ•°"}},[t._v("#")]),t._v(" renderWithHooks æ‰§è¡Œå‡½æ•°")]),t._v(" "),s("p",[t._v("å¯¹äº"),s("code",[t._v("function")]),t._v("ç»„ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„å‘¢ï¼Ÿ")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("react-reconciler/src/ReactFiberBeginWork.js\n")])])]),s("p",[s("code",[t._v("function")]),t._v("ç»„ä»¶åˆå§‹åŒ–ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderWithHooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current Fiber")]),t._v("\n    workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// workInProgress Fiber")]),t._v("\n    Component"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‡½æ•°ç»„ä»¶æœ¬èº«")]),t._v("\n    props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// props")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸Šä¸‹æ–‡")]),t._v("\n    renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¸²æŸ“ ExpirationTime")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("å¯¹äºåˆå§‹åŒ–æ˜¯æ²¡æœ‰"),s("code",[t._v("current")]),t._v("æ ‘çš„ï¼Œä¹‹åå®Œæˆä¸€æ¬¡ç»„ä»¶æ›´æ–°åï¼Œä¼šæŠŠå½“å‰"),s("code",[t._v("workInProgress")]),t._v("æ ‘èµ‹å€¼ç»™"),s("code",[t._v("current")]),t._v("æ ‘ã€‚")]),t._v(" "),s("p",[s("code",[t._v("function")]),t._v("ç»„ä»¶æ›´æ–°ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderWithHooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    render"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nextProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("æˆ‘ä»¬ä»ä¸Šè¾¹å¯ä»¥çœ‹å‡ºæ¥ï¼Œ"),s("code",[t._v("renderWithHooks")]),t._v("å‡½æ•°ä½œç”¨æ˜¯"),s("strong",[t._v("è°ƒç”¨"),s("code",[t._v("function")]),t._v("ç»„ä»¶å‡½æ•°")]),t._v("çš„ä¸»è¦å‡½æ•°ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹"),s("code",[t._v("renderWithHooks")]),t._v("åšäº†äº›ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("renderWithHooks")]),t._v(" "),s("code",[t._v("react-reconciler/src/ReactFiberHooks.js")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderWithHooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Component"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  secondArg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  nextRenderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  renderExpirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextRenderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  currentlyRenderingFiber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updateQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NoWork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  ReactCurrentDispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n      current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" HooksDispatcherOnMount\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" HooksDispatcherOnUpdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" children "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" secondArg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ....è¿™é‡Œçš„é€»è¾‘æˆ‘ä»¬å…ˆæ”¾ä¸€æ”¾")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  ReactCurrentDispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ContextOnlyDispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  renderExpirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NoWork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  currentlyRenderingFiber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  currentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  didScheduleRenderPhaseUpdate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" children"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("æ‰€æœ‰çš„å‡½æ•°ç»„ä»¶æ‰§è¡Œï¼Œéƒ½æ˜¯åœ¨è¿™é‡Œæ–¹æ³•ä¸­")]),t._v(",é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ˜ç™½å‡ ä¸ªæ„Ÿå¿µï¼Œè¿™å¯¹äºåç»­æˆ‘ä»¬ç†è§£"),s("code",[t._v("useState")]),t._v("æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚")]),t._v(" "),s("p",[s("code",[t._v("current fiberæ ‘")]),t._v(": å½“å®Œæˆä¸€æ¬¡æ¸²æŸ“ä¹‹åï¼Œä¼šäº§ç”Ÿä¸€ä¸ª"),s("code",[t._v("current")]),t._v("æ ‘,"),s("code",[t._v("current")]),t._v("ä¼šåœ¨"),s("code",[t._v("commit")]),t._v("é˜¶æ®µæ›¿æ¢æˆçœŸå®çš„"),s("code",[t._v("Dom")]),t._v("æ ‘ã€‚")]),t._v(" "),s("p",[s("code",[t._v("workInProgress fiberæ ‘")]),t._v(": å³å°†è°ƒå’Œæ¸²æŸ“çš„ "),s("code",[t._v("fiber")]),t._v(" æ ‘ã€‚å†ä¸€æ¬¡æ–°çš„ç»„ä»¶æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¼šä»"),s("code",[t._v("current")]),t._v("å¤åˆ¶ä¸€ä»½ä½œä¸º"),s("code",[t._v("workInProgress")]),t._v(",æ›´æ–°å®Œæ¯•åï¼Œå°†å½“å‰çš„"),s("code",[t._v("workInProgress")]),t._v("æ ‘èµ‹å€¼ç»™"),s("code",[t._v("current")]),t._v("æ ‘ã€‚")]),t._v(" "),s("p",[s("code",[t._v("workInProgress.memoizedState")]),t._v(": åœ¨"),s("code",[t._v("class")]),t._v("ç»„ä»¶ä¸­ï¼Œ"),s("code",[t._v("memoizedState")]),t._v("å­˜æ”¾"),s("code",[t._v("state")]),t._v("ä¿¡æ¯ï¼Œåœ¨"),s("code",[t._v("function")]),t._v("ç»„ä»¶ä¸­ï¼Œ"),s("strong",[t._v("è¿™é‡Œå¯ä»¥æå‰é€æ¼ä¸€ä¸‹ï¼Œ"),s("code",[t._v("memoizedState")]),t._v("åœ¨ä¸€æ¬¡è°ƒå’Œæ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œä»¥é“¾è¡¨çš„å½¢å¼å­˜æ”¾"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯ã€‚")])]),t._v(" "),s("p",[s("code",[t._v("workInProgress.expirationTime")]),t._v(": "),s("code",[t._v("react")]),t._v("ç”¨ä¸åŒçš„"),s("code",[t._v("expirationTime")]),t._v(",æ¥ç¡®å®šæ›´æ–°çš„ä¼˜å…ˆçº§ã€‚")]),t._v(" "),s("p",[s("code",[t._v("currentHook")]),t._v(" : å¯ä»¥ç†è§£ "),s("code",[t._v("current")]),t._v("æ ‘ä¸Šçš„æŒ‡å‘çš„å½“å‰è°ƒåº¦çš„ "),s("code",[t._v("hooks")]),t._v("èŠ‚ç‚¹ã€‚")]),t._v(" "),s("p",[s("code",[t._v("workInProgressHook")]),t._v(" : å¯ä»¥ç†è§£ "),s("code",[t._v("workInProgress")]),t._v("æ ‘ä¸ŠæŒ‡å‘çš„å½“å‰è°ƒåº¦çš„ "),s("code",[t._v("hooks")]),t._v("èŠ‚ç‚¹ã€‚")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("renderWithHooks")]),t._v("å‡½æ•°ä¸»è¦ä½œç”¨:")])]),t._v(" "),s("p",[t._v("é¦–å…ˆå…ˆç½®ç©ºå³å°†è°ƒå’Œæ¸²æŸ“çš„"),s("code",[t._v("workInProgress")]),t._v("æ ‘çš„"),s("code",[t._v("memoizedState")]),t._v("å’Œ"),s("code",[t._v("updateQueue")]),t._v("ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå› ä¸ºåœ¨æ¥ä¸‹æ¥çš„å‡½æ•°ç»„ä»¶æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¦æŠŠæ–°çš„"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯æŒ‚è½½åˆ°è¿™ä¸¤ä¸ªå±æ€§ä¸Šï¼Œç„¶ååœ¨ç»„ä»¶"),s("code",[t._v("commit")]),t._v("é˜¶æ®µï¼Œå°†"),s("code",[t._v("workInProgress")]),t._v("æ ‘æ›¿æ¢æˆ"),s("code",[t._v("current")]),t._v("æ ‘ï¼Œæ›¿æ¢çœŸå®çš„"),s("code",[t._v("DOM")]),t._v("å…ƒç´ èŠ‚ç‚¹ã€‚å¹¶åœ¨"),s("code",[t._v("current")]),t._v("æ ‘ä¿å­˜"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯ã€‚")]),t._v(" "),s("p",[t._v("ç„¶åæ ¹æ®å½“å‰å‡½æ•°ç»„ä»¶æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œèµ‹äºˆ"),s("code",[t._v("ReactCurrentDispatcher.current")]),t._v("ä¸åŒçš„"),s("code",[t._v("hooks")]),t._v(",ç»ˆäºå’Œä¸Šé¢è®²åˆ°çš„"),s("code",[t._v("ReactCurrentDispatcher")]),t._v("è”ç³»åˆ°ä¸€èµ·ã€‚å¯¹äºç¬¬ä¸€æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œé‚£ä¹ˆç”¨çš„æ˜¯"),s("code",[t._v("HooksDispatcherOnMount")]),t._v(" hookså¯¹è±¡ã€‚å¯¹äºæ¸²æŸ“åï¼Œéœ€è¦æ›´æ–°çš„å‡½æ•°ç»„ä»¶ï¼Œåˆ™æ˜¯"),s("code",[t._v("HooksDispatcherOnUpdate")]),t._v("å¯¹è±¡ï¼Œé‚£ä¹ˆä¸¤ä¸ªä¸åŒå°±æ˜¯é€šè¿‡"),s("code",[t._v("current")]),t._v("æ ‘ä¸Šæ˜¯å¦"),s("code",[t._v("memoizedState")]),t._v("ï¼ˆhookä¿¡æ¯ï¼‰æ¥åˆ¤æ–­çš„ã€‚å¦‚æœ"),s("code",[t._v("current")]),t._v("ä¸å­˜åœ¨ï¼Œè¯æ˜æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“å‡½æ•°ç»„ä»¶ã€‚")]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥ï¼Œ"),s("strong",[t._v("è°ƒç”¨"),s("code",[t._v("Component(props, secondArg);")]),t._v("æ‰§è¡Œæˆ‘ä»¬çš„å‡½æ•°ç»„ä»¶ï¼Œæˆ‘ä»¬çš„å‡½æ•°ç»„ä»¶åœ¨è¿™é‡ŒçœŸæ­£çš„è¢«æ‰§è¡Œäº†ï¼Œç„¶åï¼Œæˆ‘ä»¬å†™çš„"),s("code",[t._v("hooks")]),t._v("è¢«ä¾æ¬¡æ‰§è¡Œï¼ŒæŠŠ"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯ä¾æ¬¡ä¿å­˜åˆ°"),s("code",[t._v("workInProgress")]),t._v("æ ‘ä¸Šã€‚")]),t._v(" è‡³äºå®ƒæ˜¯æ€ä¹ˆä¿å­˜çš„ï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šè®²åˆ°ã€‚")]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥ï¼Œä¹Ÿå¾ˆé‡è¦ï¼Œå°†"),s("code",[t._v("ContextOnlyDispatcher")]),t._v("èµ‹å€¼ç»™"),s("code",[t._v("ReactCurrentDispatcher.current")]),t._v("ï¼Œç”±äº"),s("code",[t._v("js")]),t._v("æ˜¯å•çº¿ç¨‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ²¡æœ‰åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œè°ƒç”¨çš„"),s("code",[t._v("hooks")]),t._v("ï¼Œéƒ½æ˜¯"),s("code",[t._v("ContextOnlyDispatcher")]),t._v("å¯¹è±¡ä¸Š"),s("code",[t._v("hooks")]),t._v(",æˆ‘ä»¬çœ‹çœ‹"),s("code",[t._v("ContextOnlyDispatcher")]),t._v("hooksï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆã€‚")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ContextOnlyDispatcher "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("throwInvalidHookError\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("throwInvalidHookError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("invariant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' one of the following reasons:\\n'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1. You might have mismatching versions of React and the renderer (such as React DOM)\\n'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2. You might be breaking the Rules of Hooks\\n'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3. You might have more than one copy of React in the same app\\n'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'See https://fb.me/react-invalid-hook-call for tips about how to debug and fix this problem.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åŸæ¥å¦‚æ­¤ï¼Œ"),s("code",[t._v("react-hooks")]),t._v("å°±æ˜¯é€šè¿‡è¿™ç§å‡½æ•°ç»„ä»¶æ‰§è¡Œèµ‹å€¼ä¸åŒçš„"),s("code",[t._v("hooks")]),t._v("å¯¹è±¡æ–¹å¼ï¼Œåˆ¤æ–­åœ¨"),s("code",[t._v("hooks")]),t._v("æ‰§è¡Œæ˜¯å¦åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨ï¼Œæ•è·å¹¶æŠ›å‡ºå¼‚å¸¸çš„ã€‚")]),t._v(" "),s("p",[t._v("æœ€åï¼Œé‡æ–°ç½®ç©ºä¸€äº›å˜é‡æ¯”å¦‚"),s("code",[t._v("currentHook")]),t._v("ï¼Œ"),s("code",[t._v("currentlyRenderingFiber")]),t._v(","),s("code",[t._v("workInProgressHook")]),t._v("ç­‰ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_3-ä¸åŒçš„hookså¯¹è±¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ä¸åŒçš„hookså¯¹è±¡"}},[t._v("#")]),t._v(" 3 ä¸åŒçš„"),s("code",[t._v("hooks")]),t._v("å¯¹è±¡")]),t._v(" "),s("p",[t._v("ä¸Šè¿°è®²åˆ°åœ¨å‡½æ•°ç¬¬ä¸€æ¬¡æ¸²æŸ“ç»„ä»¶å’Œæ›´æ–°ç»„ä»¶åˆ†åˆ«è°ƒç”¨ä¸åŒçš„"),s("code",[t._v("hooks")]),t._v("å¯¹è±¡ï¼Œæˆ‘ä»¬ç°åœ¨å°±æ¥çœ‹çœ‹"),s("code",[t._v("HooksDispatcherOnMount")]),t._v(" å’Œ "),s("code",[t._v("HooksDispatcherOnUpdate")]),t._v("ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("ç¬¬ä¸€æ¬¡æ¸²æŸ“(æˆ‘è¿™é‡Œåªå±•ç¤ºäº†å¸¸ç”¨çš„"),s("code",[t._v("hooks")]),t._v(")ï¼š")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\nconst HooksDispatcherOnMount = {\n  useCallback: mountCallback,\n  useEffect: mountEffect,\n  useLayoutEffect: mountLayoutEffect,\n  useMemo: mountMemo,\n  useReducer: mountReducer,\n  useRef: mountRef,\n  useState: mountState,\n};\n")])])]),s("p",[s("strong",[t._v("æ›´æ–°ç»„ä»¶ï¼š")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const HooksDispatcherOnUpdate = {\n  useCallback: updateCallback,\n  useEffect: updateEffect,\n  useLayoutEffect: updateLayoutEffect,\n  useMemo: updateMemo,\n  useReducer: updateReducer,\n  useRef: updateRef,\n  useState: updateState\n};\n")])])]),s("p",[t._v("çœ‹æ¥å¯¹äºç¬¬ä¸€æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œå’Œæ›´æ–°ç»„ä»¶ï¼Œ"),s("code",[t._v("react-hooks")]),t._v("é‡‡ç”¨äº†ä¸¤å¥—"),s("code",[t._v("Api")]),t._v("ï¼Œæœ¬æ–‡çš„ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†ï¼Œå°†é‡ç‚¹ä¸¤è€…çš„è”ç³»ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬ç”¨æµç¨‹å›¾æ¥æè¿°æ•´ä¸ªè¿‡ç¨‹ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9LcnSriatHd9Jx7JTQIEuZSPkTH5DC14Qctm8htcs1hFtb9gpY48JQXQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h2",{attrs:{id:"ä¸‰-hooksåˆå§‹åŒ–-æˆ‘ä»¬å†™çš„hooksä¼šå˜æˆä»€ä¹ˆæ ·å­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰-hooksåˆå§‹åŒ–-æˆ‘ä»¬å†™çš„hooksä¼šå˜æˆä»€ä¹ˆæ ·å­"}},[t._v("#")]),t._v(" ä¸‰ hooksåˆå§‹åŒ–ï¼Œæˆ‘ä»¬å†™çš„hooksä¼šå˜æˆä»€ä¹ˆæ ·å­")]),t._v(" "),s("p",[t._v("æœ¬æ–‡å°†é‡ç‚¹å›´ç»•å››ä¸ªä¸­é‡ç‚¹"),s("code",[t._v("hooks")]),t._v("å±•å¼€ï¼Œåˆ†åˆ«æ˜¯è´Ÿè´£ç»„ä»¶æ›´æ–°çš„"),s("code",[t._v("useState")]),t._v("ï¼Œè´Ÿè´£æ‰§è¡Œå‰¯ä½œç”¨"),s("code",[t._v("useEffect")]),t._v(" ,è´Ÿè´£ä¿å­˜æ•°æ®çš„"),s("code",[t._v("useRef")]),t._v(",è´Ÿè´£ç¼“å­˜ä¼˜åŒ–çš„"),s("code",[t._v("useMemo")]),t._v("ï¼Œ è‡³äº"),s("code",[t._v("useCallback")]),t._v(","),s("code",[t._v("useReducer")]),t._v(","),s("code",[t._v("useLayoutEffect")]),t._v("åŸç†å’Œé‚£å››ä¸ªé‡ç‚¹"),s("code",[t._v("hooks")]),t._v("æ¯”è¾ƒç›¸è¿‘ï¼Œå°±ä¸ä¸€ä¸€è§£é‡Šäº†ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶ä¸”ç”¨åˆ°ä¸Šè¿°å››ä¸ªä¸»è¦"),s("code",[t._v("hooks")]),t._v("ï¼š")]),t._v(" "),s("p",[s("strong",[t._v("è¯·è®°ä½å¦‚ä¸‹ä»£ç ç‰‡æ®µï¼Œåé¢è®²è§£å°†ä»¥å¦‚ä¸‹ä»£ç æ®µå±•å¼€")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useEffect "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useState "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useRef "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useMemo  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" number "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setNumber "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" DivDemo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useMemo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" hello "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i am useMemo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" curRef  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curRef"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div ref"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" curRef "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("world "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" number "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" DivDemo "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNumber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·ç ”ç©¶ä¸€ä¸‹æˆ‘ä»¬ä¸Šè¿°å†™çš„å››ä¸ª"),s("code",[t._v("hooks")]),t._v("æœ€ç»ˆä¼šå˜æˆä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("h3",{attrs:{id:"_1-mountworkinprogresshook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-mountworkinprogresshook"}},[t._v("#")]),t._v(" 1 mountWorkInProgressHook")]),t._v(" "),s("p",[t._v("åœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™,æ¯ä¸€æ¬¡"),s("code",[t._v("hooks")]),t._v("æ‰§è¡Œï¼Œå¦‚"),s("code",[t._v("useState()")]),t._v(","),s("code",[t._v("useRef()")]),t._v(",éƒ½ä¼šè°ƒç”¨"),s("code",[t._v("mountWorkInProgressHook")]),t._v(","),s("code",[t._v("mountWorkInProgressHook")]),t._v("åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("react-reconciler/src/ReactFiberHooks.js -> mountWorkInProgressHook\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hook")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("memoizedState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// useStateä¸­ ä¿å­˜ stateä¿¡æ¯ ï½œ useEffect ä¸­ ä¿å­˜ç€ effect å¯¹è±¡ ï½œ useMemo ä¸­ ä¿å­˜çš„æ˜¯ç¼“å­˜çš„å€¼å’Œdeps ï½œ useRefä¸­ä¿å­˜çš„æ˜¯ref å¯¹è±¡")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("baseState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("baseQueue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("queue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¾‹å­ä¸­çš„ç¬¬ä¸€ä¸ª`hooks`-> useState(0) èµ°çš„å°±æ˜¯è¿™æ ·ã€‚")]),t._v("\n    currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("mountWorkInProgressHook")]),t._v("è¿™ä¸ªå‡½æ•°åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œé¦–å…ˆæ¯æ¬¡æ‰§è¡Œä¸€ä¸ª"),s("code",[t._v("hooks")]),t._v("å‡½æ•°ï¼Œéƒ½äº§ç”Ÿä¸€ä¸ª"),s("code",[t._v("hook")]),t._v("å¯¹è±¡ï¼Œé‡Œé¢ä¿å­˜äº†å½“å‰"),s("code",[t._v("hook")]),t._v("ä¿¡æ¯,ç„¶åå°†æ¯ä¸ª"),s("code",[t._v("hooks")]),t._v("ä»¥é“¾è¡¨å½¢å¼ä¸²è”èµ·æ¥ï¼Œå¹¶èµ‹å€¼ç»™"),s("code",[t._v("workInProgress")]),t._v("çš„"),s("code",[t._v("memoizedState")]),t._v("ã€‚ä¹Ÿå°±è¯å®äº†ä¸Šè¿°æ‰€è¯´çš„ï¼Œå‡½æ•°ç»„ä»¶ç”¨"),s("code",[t._v("memoizedState")]),t._v("å­˜æ”¾"),s("code",[t._v("hooks")]),t._v("é“¾è¡¨ã€‚")]),t._v(" "),s("p",[t._v("è‡³äº"),s("code",[t._v("hook")]),t._v("å¯¹è±¡ä¸­éƒ½ä¿ç•™äº†å“ªäº›ä¿¡æ¯ï¼Ÿæˆ‘è¿™é‡Œå…ˆåˆ†åˆ«ä»‹ç»ä¸€ä¸‹ :")]),t._v(" "),s("p",[s("strong",[t._v("memoizedState")]),t._v("ï¼š "),s("code",[t._v("useStateä¸­")]),t._v(" ä¿å­˜ "),s("code",[t._v("state")]),t._v(" ä¿¡æ¯ ï½œ "),s("code",[t._v("useEffect")]),t._v(" ä¸­ ä¿å­˜ç€ "),s("code",[t._v("effect")]),t._v(" å¯¹è±¡ ï½œ "),s("code",[t._v("useMemo")]),t._v(" ä¸­ ä¿å­˜çš„æ˜¯ç¼“å­˜çš„å€¼å’Œ "),s("code",[t._v("deps")]),t._v(" ï½œ "),s("code",[t._v("useRef")]),t._v(" ä¸­ä¿å­˜çš„æ˜¯ "),s("code",[t._v("ref")]),t._v(" å¯¹è±¡ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("baseState")]),t._v(" : "),s("code",[t._v("usestate")]),t._v("å’Œ"),s("code",[t._v("useReducer")]),t._v("ä¸­ ä¿å­˜æœ€æ–°çš„æ›´æ–°é˜Ÿåˆ—ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("baseState")]),t._v(" ï¼š "),s("code",[t._v("usestate")]),t._v("å’Œ"),s("code",[t._v("useReducer")]),t._v("ä¸­,ä¸€æ¬¡æ›´æ–°ä¸­ ï¼Œäº§ç”Ÿçš„æœ€æ–°"),s("code",[t._v("state")]),t._v("å€¼ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("queue")]),t._v(" ï¼šä¿å­˜å¾…æ›´æ–°é˜Ÿåˆ— "),s("code",[t._v("pendingQueue")]),t._v(" ï¼Œæ›´æ–°å‡½æ•° "),s("code",[t._v("dispatch")]),t._v(" ç­‰ä¿¡æ¯ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("next")]),t._v(": æŒ‡å‘ä¸‹ä¸€ä¸ª "),s("code",[t._v("hooks")]),t._v("å¯¹è±¡ã€‚")]),t._v(" "),s("p",[t._v("é‚£ä¹ˆå½“æˆ‘ä»¬å‡½æ•°ç»„ä»¶æ‰§è¡Œä¹‹åï¼Œå››ä¸ª"),s("code",[t._v("hooks")]),t._v("å’Œ"),s("code",[t._v("workInProgress")]),t._v("å°†æ˜¯å¦‚å›¾çš„å…³ç³»ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9qZXHmqqVpEuxe38Ints9shhqIpw0fcjYtWOiaZXP3JIsSnLpEMkzaVw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("çŸ¥é“æ¯ä¸ª"),s("code",[t._v("hooks")]),t._v("å…³ç³»ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥ç†è§£äº†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½æ¡ä»¶è¯­å¥ä¸­ï¼Œå£°æ˜"),s("code",[t._v("hooks")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬ç”¨ä¸€å¹…å›¾è¡¨ç¤ºå¦‚æœåœ¨æ¡ä»¶è¯­å¥ä¸­å£°æ˜ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘ç”Ÿã€‚")]),t._v(" "),s("p",[t._v("å¦‚æœæˆ‘ä»¬å°†ä¸Šè¿°"),s("code",[t._v("demo")]),t._v("å…¶ä¸­çš„ä¸€ä¸ª "),s("code",[t._v("useRef")]),t._v(" æ”¾å…¥æ¡ä»¶è¯­å¥ä¸­ï¼Œ")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" curRef  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isFisrt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  curRef "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf90Ka0x0zMCRHYp40eibCoqWPoXicAPZU99OY2F2puicstuvR46RmHYaNGw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[s("strong",[t._v("å› ä¸ºä¸€æ—¦åœ¨æ¡ä»¶è¯­å¥ä¸­å£°æ˜"),s("code",[t._v("hooks")]),t._v("ï¼Œåœ¨ä¸‹ä¸€æ¬¡å‡½æ•°ç»„ä»¶æ›´æ–°ï¼Œ"),s("code",[t._v("hooks")]),t._v("é“¾è¡¨ç»“æ„ï¼Œå°†ä¼šè¢«ç ´åï¼Œ"),s("code",[t._v("current")]),t._v("æ ‘çš„"),s("code",[t._v("memoizedState")]),t._v("ç¼“å­˜"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯ï¼Œå’Œå½“å‰"),s("code",[t._v("workInProgress")]),t._v("ä¸ä¸€è‡´ï¼Œå¦‚æœæ¶‰åŠåˆ°è¯»å–"),s("code",[t._v("state")]),t._v("ç­‰æ“ä½œï¼Œå°±ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚")])]),t._v(" "),s("p",[t._v("ä¸Šè¿°ä»‹ç»äº† "),s("code",[t._v("hooks")]),t._v("é€šè¿‡ä»€ä¹ˆæ¥è¯æ˜å”¯ä¸€æ€§çš„ï¼Œç­”æ¡ˆ ï¼Œé€šè¿‡"),s("code",[t._v("hooks")]),t._v("é“¾è¡¨é¡ºåºã€‚å’Œä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­ï¼Œå£°æ˜"),s("code",[t._v("hooks")]),t._v("ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŒ‰ç…§å››ä¸ªæ–¹å‘ï¼Œåˆ†åˆ«ä»‹ç»åˆå§‹åŒ–çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("h3",{attrs:{id:"_2-åˆå§‹åŒ–usestate-mountstate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-åˆå§‹åŒ–usestate-mountstate"}},[t._v("#")]),t._v(" 2 åˆå§‹åŒ–useState -> mountState")]),t._v(" "),s("p",[s("strong",[t._v("mountState")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialState")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" initialState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœ useState ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œæ‰§è¡Œå‡½æ•°å¾—åˆ°state")]),t._v("\n    initialState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initialState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" initialState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" queue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("queue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pending")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¸¦æ›´æ–°çš„")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dispatch")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è´Ÿè´£æ›´æ–°å‡½æ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lastRenderedReducer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" basicStateReducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ç”¨äºå¾—åˆ°æœ€æ–°çš„ state ,")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lastRenderedState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" initialState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€åä¸€æ¬¡å¾—åˆ°çš„ state")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dispatch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchAction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è´Ÿè´£æ›´æ–°çš„å‡½æ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("mountState")]),t._v("åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Œé¦–å…ˆä¼šå¾—åˆ°åˆå§‹åŒ–çš„"),s("code",[t._v("state")]),t._v("ï¼Œå°†å®ƒèµ‹å€¼ç»™"),s("code",[t._v("mountWorkInProgressHook")]),t._v("äº§ç”Ÿçš„"),s("code",[t._v("hook")]),t._v("å¯¹è±¡çš„ "),s("code",[t._v("memoizedState")]),t._v("å’Œ"),s("code",[t._v("baseState")]),t._v("å±æ€§ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª"),s("code",[t._v("queue")]),t._v("å¯¹è±¡ï¼Œé‡Œé¢ä¿å­˜äº†è´Ÿè´£æ›´æ–°çš„ä¿¡æ¯ã€‚")]),t._v(" "),s("p",[t._v("è¿™é‡Œå…ˆè¯´ä¸€ä¸‹ï¼Œåœ¨æ— çŠ¶æ€ç»„ä»¶ä¸­ï¼Œ"),s("code",[t._v("useState")]),t._v("å’Œ"),s("code",[t._v("useReducer")]),t._v("è§¦å‘å‡½æ•°æ›´æ–°çš„æ–¹æ³•éƒ½æ˜¯"),s("code",[t._v("dispatchAction")]),t._v(","),s("code",[t._v("useState")]),t._v("ï¼Œå¯ä»¥çœ‹æˆä¸€ä¸ªç®€åŒ–ç‰ˆçš„"),s("code",[t._v("useReducer")]),t._v(",è‡³äº"),s("code",[t._v("dispatchAction")]),t._v("æ€ä¹ˆæ›´æ–°"),s("code",[t._v("state")]),t._v("ï¼Œæ›´æ–°ç»„ä»¶çš„ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹ç ”ç©¶"),s("code",[t._v("dispatchAction")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("åœ¨ç ”ç©¶ä¹‹å‰ æˆ‘ä»¬"),s("strong",[t._v("å…ˆè¦å¼„æ˜ç™½"),s("code",[t._v("dispatchAction")]),t._v("æ˜¯ä»€ä¹ˆ?")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" dispatchAction"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("S")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fiber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("queue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" UpdateQueue"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("S")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("action")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" number "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setNumber "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[s("code",[t._v("dispatchAction")]),t._v(" å°±æ˜¯ "),s("code",[t._v("setNumber")])]),t._v(" , "),s("code",[t._v("dispatchAction")]),t._v(" ç¬¬ä¸€ä¸ªå‚æ•°å’Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå·²ç»è¢«"),s("code",[t._v("bind")]),t._v("ç»™æ”¹æˆ"),s("code",[t._v("currentlyRenderingFiber")]),t._v("å’Œ "),s("code",[t._v("queue")]),t._v(",æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°"),s("code",[t._v("action")])]),t._v(" "),s("h4",{attrs:{id:"dispatchaction-æ— çŠ¶æ€ç»„ä»¶æ›´æ–°æœºåˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dispatchaction-æ— çŠ¶æ€ç»„ä»¶æ›´æ–°æœºåˆ¶"}},[t._v("#")]),t._v(" dispatchAction æ— çŠ¶æ€ç»„ä»¶æ›´æ–°æœºåˆ¶")]),t._v(" "),s("p",[t._v("ä½œä¸ºæ›´æ–°çš„ä¸»è¦å‡½æ•°ï¼Œæˆ‘ä»¬ä¸€ä¸‹æ¥ç ”ç©¶ä¸€ä¸‹ï¼Œæˆ‘æŠŠ "),s("code",[t._v("dispatchAction")]),t._v(" ç²¾ç®€ï¼Œç²¾ç®€ï¼Œå†ç²¾ç®€ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchAction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¡ç®— expirationTime è¿‡ç¨‹ç•¥è¿‡ã€‚")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åˆ›å»ºä¸€ä¸ªupdate */")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    expirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    suspenseConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("eagerReducer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("eagerState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æŠŠåˆ›å»ºçš„update */")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯æ˜ç¬¬ä¸€æ¬¡æ›´æ–°")]),t._v("\n    update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸æ˜¯ç¬¬ä¸€æ¬¡æ›´æ–°")]),t._v("\n    update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" alternate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alternate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* åˆ¤æ–­å½“å‰æ˜¯å¦åœ¨æ¸²æŸ“é˜¶æ®µ */")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" fiber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" currentlyRenderingFiber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("alternate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" alternate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    didScheduleRenderPhaseUpdate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å½“å‰å‡½æ•°ç»„ä»¶å¯¹åº”fiberæ²¡æœ‰å¤„äºè°ƒå’Œæ¸²æŸ“é˜¶æ®µ ï¼Œé‚£ä¹ˆè·å–æœ€æ–°state , æ‰§è¡Œæ›´æ–° */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" NoWork "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("alternate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" alternate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" NoWork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastRenderedReducer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastRenderedReducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastRenderedReducer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" prevDispatcher"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" currentState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastRenderedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ä¸Šä¸€æ¬¡çš„state */")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" eagerState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lastRenderedReducer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**/")]),t._v("\n          update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eagerReducer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lastRenderedReducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eagerState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" eagerState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eagerState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" currentState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scheduleUpdateOnFiber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" expirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æ— è®ºæ˜¯ç±»ç»„ä»¶è°ƒç”¨"),s("code",[t._v("setState")]),t._v(",è¿˜æ˜¯å‡½æ•°ç»„ä»¶çš„"),s("code",[t._v("dispatchAction")]),t._v(" ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ª "),s("code",[t._v("update")]),t._v("å¯¹è±¡ï¼Œé‡Œé¢è®°å½•äº†æ­¤æ¬¡æ›´æ–°çš„ä¿¡æ¯ï¼Œç„¶åå°†æ­¤"),s("code",[t._v("update")]),t._v("æ”¾å…¥å¾…æ›´æ–°çš„"),s("code",[t._v("pending")]),t._v("é˜Ÿåˆ—ä¸­ï¼Œ"),s("code",[t._v("dispatchAction")]),t._v("ç¬¬äºŒæ­¥å°±æ˜¯åˆ¤æ–­å½“å‰å‡½æ•°ç»„ä»¶çš„"),s("code",[t._v("fiber")]),t._v("å¯¹è±¡æ˜¯å¦å¤„äºæ¸²æŸ“é˜¶æ®µï¼Œå¦‚æœå¤„äºæ¸²æŸ“é˜¶æ®µï¼Œé‚£ä¹ˆä¸éœ€è¦æˆ‘ä»¬åœ¨æ›´æ–°å½“å‰å‡½æ•°ç»„ä»¶ï¼Œåªéœ€è¦æ›´æ–°ä¸€ä¸‹å½“å‰"),s("code",[t._v("update")]),t._v("çš„"),s("code",[t._v("expirationTime")]),t._v("å³å¯ã€‚")]),t._v(" "),s("p",[t._v("å¦‚æœå½“å‰"),s("code",[t._v("fiber")]),t._v("æ²¡æœ‰å¤„äºæ›´æ–°é˜¶æ®µã€‚é‚£ä¹ˆé€šè¿‡è°ƒç”¨"),s("code",[t._v("lastRenderedReducer")]),t._v("è·å–æœ€æ–°çš„"),s("code",[t._v("state")]),t._v(",å’Œä¸Šä¸€æ¬¡çš„"),s("code",[t._v("currentState")]),t._v("ï¼Œè¿›è¡Œæµ…æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰ï¼Œé‚£ä¹ˆå°±é€€å‡ºï¼Œè¿™å°±è¯å®äº†ä¸ºä»€ä¹ˆ"),s("code",[t._v("useState")]),t._v("ï¼Œä¸¤æ¬¡å€¼ç›¸ç­‰çš„æ—¶å€™ï¼Œç»„ä»¶ä¸æ¸²æŸ“çš„åŸå› äº†ï¼Œè¿™ä¸ªæœºåˆ¶å’Œ"),s("code",[t._v("Component")]),t._v("æ¨¡å¼ä¸‹çš„"),s("code",[t._v("setState")]),t._v("æœ‰ä¸€å®šçš„åŒºåˆ«ã€‚")]),t._v(" "),s("p",[t._v("å¦‚æœä¸¤æ¬¡"),s("code",[t._v("state")]),t._v("ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆè°ƒç”¨"),s("code",[t._v("scheduleUpdateOnFiber")]),t._v("è°ƒåº¦æ¸²æŸ“å½“å‰"),s("code",[t._v("fiber")]),t._v("ï¼Œ"),s("code",[t._v("scheduleUpdateOnFiber")]),t._v("æ˜¯"),s("code",[t._v("react")]),t._v("æ¸²æŸ“æ›´æ–°çš„ä¸»è¦å‡½æ•°ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æŠŠ"),s("strong",[t._v("åˆå§‹åŒ–"),s("code",[t._v("mountState")]),t._v("**å’Œ**æ— çŠ¶æ€ç»„ä»¶æ›´æ–°æœºåˆ¶")]),t._v("è®²æ˜ç™½äº†ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å…¶ä»–çš„"),s("strong",[t._v("hooks")]),t._v("åˆå§‹åŒ–åšäº†äº›ä»€ä¹ˆæ“ä½œï¼Ÿ")]),t._v(" "),s("h3",{attrs:{id:"_3-åˆå§‹åŒ–useeffect-mounteffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-åˆå§‹åŒ–useeffect-mounteffect"}},[t._v("#")]),t._v(" 3 åˆå§‹åŒ–useEffect -> mountEffect")]),t._v(" "),s("p",[t._v("ä¸Šè¿°è®²åˆ°äº†æ— çŠ¶æ€ç»„ä»¶ä¸­"),s("code",[t._v("fiber")]),t._v("å¯¹è±¡"),s("code",[t._v("memoizedState")]),t._v("ä¿å­˜å½“å‰çš„"),s("code",[t._v("hooks")]),t._v("å½¢æˆçš„é“¾è¡¨ã€‚é‚£ä¹ˆ"),s("code",[t._v("updateQueue")]),t._v("ä¿å­˜äº†ä»€ä¹ˆä¿¡æ¯å‘¢ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥æ¢ç´¢"),s("code",[t._v("useEffect")]),t._v("è¿‡ç¨‹ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚å½“æˆ‘ä»¬è°ƒç”¨"),s("code",[t._v("useEffect")]),t._v("çš„æ—¶å€™ï¼Œåœ¨ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ä¼šè°ƒç”¨"),s("code",[t._v("mountEffect")]),t._v("æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("h4",{attrs:{id:"mounteffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mounteffect"}},[t._v("#")]),t._v(" mountEffect")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    HookHasEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" hookEffectTag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// useEffect ç¬¬ä¸€æ¬¡å‚æ•°ï¼Œå°±æ˜¯å‰¯ä½œç”¨å‡½æ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// useEffect ç¬¬äºŒæ¬¡å‚æ•°ï¼Œdeps")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("æ¯ä¸ª"),s("code",[t._v("hooks")]),t._v("åˆå§‹åŒ–éƒ½ä¼šåˆ›å»ºä¸€ä¸ª"),s("code",[t._v("hook")]),t._v("å¯¹è±¡ï¼Œç„¶åå°†hookçš„"),s("code",[t._v("memoizedState")]),t._v("ä¿å­˜å½“å‰"),s("code",[t._v("effect hook")]),t._v("ä¿¡æ¯ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("æœ‰ä¸¤ä¸ª"),s("code",[t._v("memoizedState")]),t._v("å¤§å®¶åƒä¸‡åˆ«æ··æ·†äº†ï¼Œæˆ‘è¿™é‡Œå†å‹æƒ…æç¤ºä¸€é")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("workInProgress / current")]),t._v(" æ ‘ä¸Šçš„ "),s("code",[t._v("memoizedState")]),t._v(" ä¿å­˜çš„æ˜¯å½“å‰å‡½æ•°ç»„ä»¶æ¯ä¸ª"),s("code",[t._v("hooks")]),t._v("å½¢æˆçš„é“¾è¡¨ã€‚")]),t._v(" "),s("li",[t._v("æ¯ä¸ª"),s("code",[t._v("hooks")]),t._v("ä¸Šçš„"),s("code",[t._v("memoizedState")]),t._v(" ä¿å­˜äº†å½“å‰"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯ï¼Œä¸åŒç§ç±»çš„"),s("code",[t._v("hooks")]),t._v("çš„"),s("code",[t._v("memoizedState")]),t._v("å†…å®¹ä¸åŒã€‚ä¸Šè¿°çš„æ–¹æ³•æœ€åæ‰§è¡Œäº†ä¸€ä¸ª"),s("code",[t._v("pushEffect")]),t._v("ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹"),s("code",[t._v("pushEffect")]),t._v("åšäº†äº›ä»€ä¹ˆï¼Ÿ")])]),t._v(" "),s("h4",{attrs:{id:"pusheffect-åˆ›å»ºeffectå¯¹è±¡-æŒ‚è½½updatequeue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pusheffect-åˆ›å»ºeffectå¯¹è±¡-æŒ‚è½½updatequeue"}},[t._v("#")]),t._v(" pushEffect åˆ›å»ºeffectå¯¹è±¡ï¼ŒæŒ‚è½½updateQueue")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" destroy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" effect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    destroy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" componentUpdateQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updateQueue\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("componentUpdateQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ª useEffect")]),t._v("\n    componentUpdateQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lastEffect")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updateQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" componentUpdateQueue\n    componentUpdateQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å­˜åœ¨å¤šä¸ªeffect")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" componentUpdateQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      componentUpdateQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" firstEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lastEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      lastEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" firstEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      componentUpdateQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" effect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è¿™ä¸€æ®µå®é™…å¾ˆç®€å•ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª "),s("code",[t._v("effect")]),t._v(" ï¼Œåˆ¤æ–­ç»„ä»¶å¦‚æœç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œé‚£ä¹ˆåˆ›å»º "),s("code",[t._v("componentUpdateQueue")]),t._v(" ï¼Œå°±æ˜¯"),s("code",[t._v("workInProgress")]),t._v("çš„"),s("code",[t._v("updateQueue")]),t._v("ã€‚ç„¶åå°†"),s("code",[t._v("effect")]),t._v("æ”¾å…¥"),s("code",[t._v("updateQueue")]),t._v("ä¸­ï¼Œä¸è¿‡è¿™é‡Œé¡ºåºè¦ä¸»è¦ï¼Œè¶Šé åçš„"),s("code",[t._v("effect")]),t._v("ï¼Œè¶Šåœ¨"),s("code",[t._v("updateQueue")]),t._v("å‰è¾¹ã€‚")]),t._v(" "),s("p",[t._v("å‡è®¾æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä¸­è¿™ä¹ˆå†™ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("æœ€å"),s("code",[t._v("workInProgress.updateQueue")]),t._v("ä¼šä»¥è¿™æ ·çš„å½¢å¼ä¿å­˜ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9jNiaib0msKJErgyicLhJQicqUwicU5gf1MIUPf1ptyeT0AKnFWAzcTQGn3w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h4",{attrs:{id:"æ‹“å±•-effectlist"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‹“å±•-effectlist"}},[t._v("#")]),t._v(" æ‹“å±•:effectList")]),t._v(" "),s("p",[s("code",[t._v("effect list")]),t._v(" å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå­˜å‚¨ "),s("code",[t._v("effectTag")]),t._v(" å‰¯ä½œç”¨åˆ—è¡¨å®¹å™¨ã€‚å®ƒæ˜¯ç”± "),s("code",[t._v("fiber")]),t._v(" èŠ‚ç‚¹å’ŒæŒ‡é’ˆ "),s("code",[t._v("nextEffect")]),t._v(" æ„æˆçš„å•é“¾è¡¨ç»“æ„ï¼Œè¿™å…¶ä¸­è¿˜åŒ…æ‹¬ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ "),s("code",[t._v("firstEffect")]),t._v(" ï¼Œå’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ "),s("code",[t._v("lastEffect")]),t._v("ã€‚ "),s("code",[t._v("React")]),t._v(" é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼Œåœ¨ "),s("code",[t._v("render")]),t._v(" é˜¶æ®µéå† "),s("code",[t._v("fiber")]),t._v(" æ ‘æ—¶ï¼ŒæŠŠæ¯ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„ "),s("code",[t._v("fiber")]),t._v(" ç­›é€‰å‡ºæ¥ï¼Œæœ€åæ„å»ºç”Ÿæˆä¸€ä¸ªåªå¸¦å‰¯ä½œç”¨çš„ "),s("code",[t._v("effect list")]),t._v(" é“¾è¡¨ã€‚åœ¨ "),s("code",[t._v("commit")]),t._v(" é˜¶æ®µï¼Œ"),s("code",[t._v("React")]),t._v(" æ‹¿åˆ° "),s("code",[t._v("effect list")]),t._v(" æ•°æ®åï¼Œé€šè¿‡éå† "),s("code",[t._v("effect list")]),t._v("ï¼Œå¹¶æ ¹æ®æ¯ä¸€ä¸ª "),s("code",[t._v("effect")]),t._v(" èŠ‚ç‚¹çš„ "),s("code",[t._v("effectTag")]),t._v(" ç±»å‹ï¼Œæ‰§è¡Œæ¯ä¸ª"),s("code",[t._v("effect")]),t._v("ï¼Œä»è€Œå¯¹ç›¸åº”çš„ "),s("code",[t._v("DOM")]),t._v(" æ ‘æ‰§è¡Œæ›´æ”¹ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_4-åˆå§‹åŒ–usememo-mountmemo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-åˆå§‹åŒ–usememo-mountmemo"}},[t._v("#")]),t._v(" 4 åˆå§‹åŒ–useMemo -> mountMemo")]),t._v(" "),s("p",[t._v("ä¸çŸ¥é“å¤§å®¶æ˜¯å¦æŠŠ "),s("code",[t._v("useMemo")]),t._v(" æƒ³è±¡çš„è¿‡äºå¤æ‚äº†ï¼Œå®é™…ç›¸æ¯”å…¶ä»– "),s("code",[t._v("useState")]),t._v(" , "),s("code",[t._v("useEffect")]),t._v("ç­‰ï¼Œå®ƒçš„é€»è¾‘å®é™…ç®€å•çš„å¾ˆã€‚")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountMemo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("deps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nextValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nextValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åˆå§‹åŒ–"),s("code",[t._v("useMemo")]),t._v("ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ª"),s("code",[t._v("hook")]),t._v("ï¼Œç„¶åæ‰§è¡Œ"),s("code",[t._v("useMemo")]),t._v("çš„ç¬¬ä¸€ä¸ªå‚æ•°,å¾—åˆ°éœ€è¦ç¼“å­˜çš„å€¼ï¼Œç„¶åå°†å€¼å’Œ"),s("code",[t._v("deps")]),t._v("è®°å½•ä¸‹æ¥ï¼Œèµ‹å€¼ç»™å½“å‰"),s("code",[t._v("hook")]),t._v("çš„"),s("code",[t._v("memoizedState")]),t._v("ã€‚æ•´ä½“ä¸Šå¹¶æ²¡æœ‰å¤æ‚çš„é€»è¾‘ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_5-åˆå§‹åŒ–useref-mountref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-åˆå§‹åŒ–useref-mountref"}},[t._v("#")]),t._v(" 5 åˆå§‹åŒ–useRef -> mountRef")]),t._v(" "),s("p",[t._v("å¯¹äº"),s("code",[t._v("useRef")]),t._v("åˆå§‹åŒ–å¤„ç†ï¼Œä¼¼ä¹æ›´æ˜¯ç®€å•ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ref "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("current")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" initialValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("mountRef")]),t._v("åˆå§‹åŒ–å¾ˆç®€å•, åˆ›å»ºä¸€ä¸ªrefå¯¹è±¡ï¼Œ å¯¹è±¡çš„"),s("code",[t._v("current")]),t._v(" å±æ€§æ¥ä¿å­˜åˆå§‹åŒ–çš„å€¼ï¼Œæœ€åç”¨"),s("code",[t._v("memoizedState")]),t._v("ä¿å­˜"),s("code",[t._v("ref")]),t._v("ï¼Œå®Œæˆæ•´ä¸ªæ“ä½œã€‚")]),t._v(" "),s("h3",{attrs:{id:"_6-mounted-é˜¶æ®µ-hooks-æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-mounted-é˜¶æ®µ-hooks-æ€»ç»“"}},[t._v("#")]),t._v(" 6 mounted é˜¶æ®µ hooks æ€»ç»“")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹åˆå§‹åŒ–é˜¶æ®µ,"),s("code",[t._v("react-hooks")]),t._v("åšçš„äº‹æƒ…ï¼Œåœ¨ä¸€ä¸ªå‡½æ•°ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“æ‰§è¡Œä¸Šä¸‹æ–‡è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ª"),s("code",[t._v("react-hooks")]),t._v("æ‰§è¡Œï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ª"),s("code",[t._v("hook")]),t._v("å¯¹è±¡ï¼Œå¹¶å½¢æˆé“¾è¡¨ç»“æ„ï¼Œç»‘å®šåœ¨"),s("code",[t._v("workInProgress")]),t._v("çš„"),s("code",[t._v("memoizedState")]),t._v("å±æ€§ä¸Šï¼Œç„¶å"),s("code",[t._v("react-hooks")]),t._v("ä¸Šçš„çŠ¶æ€ï¼Œç»‘å®šåœ¨å½“å‰"),s("code",[t._v("hooks")]),t._v("å¯¹è±¡çš„"),s("code",[t._v("memoizedState")]),t._v("å±æ€§ä¸Šã€‚å¯¹äº"),s("code",[t._v("effect")]),t._v("å‰¯ä½œç”¨é’©å­ï¼Œä¼šç»‘å®šåœ¨"),s("code",[t._v("workInProgress.updateQueue")]),t._v("ä¸Šï¼Œç­‰åˆ°"),s("code",[t._v("commit")]),t._v("é˜¶æ®µï¼Œ"),s("code",[t._v("dom")]),t._v("æ ‘æ„å»ºå®Œæˆï¼Œåœ¨æ‰§è¡Œæ¯ä¸ª "),s("code",[t._v("effect")]),t._v(" å‰¯ä½œç”¨é’©å­ã€‚")]),t._v(" "),s("h2",{attrs:{id:"å››-hooksæ›´æ–°é˜¶æ®µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å››-hooksæ›´æ–°é˜¶æ®µ"}},[t._v("#")]),t._v(" å›› hooksæ›´æ–°é˜¶æ®µ")]),t._v(" "),s("p",[t._v("ä¸Šè¿°ä»‹ç»äº†ç¬¬ä¸€æ¬¡æ¸²æŸ“å‡½æ•°ç»„ä»¶ï¼Œ"),s("code",[t._v("react-hooks")]),t._v("åˆå§‹åŒ–éƒ½åšäº›ä»€ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼Œ")]),t._v(" "),s("p",[t._v("å¯¹äºæ›´æ–°é˜¶æ®µï¼Œè¯´æ˜ä¸Šä¸€æ¬¡ "),s("code",[t._v("workInProgress")]),t._v(" æ ‘å·²ç»èµ‹å€¼ç»™äº† "),s("code",[t._v("current")]),t._v(" æ ‘ã€‚å­˜æ”¾"),s("code",[t._v("hooks")]),t._v("ä¿¡æ¯çš„"),s("code",[t._v("memoizedState")]),t._v("ï¼Œæ­¤æ—¶å·²ç»å­˜åœ¨"),s("code",[t._v("current")]),t._v("æ ‘ä¸Šï¼Œ"),s("code",[t._v("react")]),t._v("å¯¹äº"),s("code",[t._v("hooks")]),t._v("çš„å¤„ç†é€»è¾‘å’Œ"),s("code",[t._v("fiber")]),t._v("æ ‘é€»è¾‘ç±»ä¼¼ã€‚")]),t._v(" "),s("p",[t._v("å¯¹äºä¸€æ¬¡å‡½æ•°ç»„ä»¶æ›´æ–°ï¼Œå½“å†æ¬¡æ‰§è¡Œ"),s("code",[t._v("hooks")]),t._v("å‡½æ•°çš„æ—¶å€™ï¼Œæ¯”å¦‚ "),s("code",[t._v("useState(0)")]),t._v(" ï¼Œé¦–å…ˆè¦ä»"),s("code",[t._v("current")]),t._v("çš„"),s("code",[t._v("hooks")]),t._v("ä¸­æ‰¾åˆ°ä¸å½“å‰"),s("code",[t._v("workInProgressHook")]),t._v("ï¼Œå¯¹åº”çš„"),s("code",[t._v("currentHooks")]),t._v("ï¼Œç„¶åå¤åˆ¶ä¸€ä»½"),s("code",[t._v("currentHooks")]),t._v("ç»™"),s("code",[t._v("workInProgressHook")]),t._v(",æ¥ä¸‹æ¥"),s("code",[t._v("hooks")]),t._v("å‡½æ•°æ‰§è¡Œçš„æ—¶å€™,æŠŠæœ€æ–°çš„çŠ¶æ€æ›´æ–°åˆ°"),s("code",[t._v("workInProgressHook")]),t._v("ï¼Œä¿è¯"),s("code",[t._v("hooks")]),t._v("çŠ¶æ€ä¸ä¸¢å¤±ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥å‡½æ•°ç»„ä»¶æ¯æ¬¡æ›´æ–°ï¼Œæ¯ä¸€æ¬¡"),s("code",[t._v("react-hooks")]),t._v("å‡½æ•°æ‰§è¡Œï¼Œéƒ½éœ€è¦æœ‰ä¸€ä¸ªå‡½æ•°å»åšä¸Šé¢çš„æ“ä½œï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯"),s("code",[t._v("updateWorkInProgressHook")]),t._v(",æˆ‘ä»¬æ¥ä¸‹æ¥ä¸€èµ·çœ‹è¿™ä¸ª"),s("code",[t._v("updateWorkInProgressHook")]),t._v("ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_1-updateworkinprogresshook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-updateworkinprogresshook"}},[t._v("#")]),t._v(" 1 updateWorkInProgressHook")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" nextCurrentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å¦‚æœ currentHook = null è¯æ˜å®ƒæ˜¯ç¬¬ä¸€ä¸ªhooks */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alternate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nextCurrentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nextCurrentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ä¸æ˜¯ç¬¬ä¸€ä¸ªhooksï¼Œé‚£ä¹ˆæŒ‡å‘ä¸‹ä¸€ä¸ª hooks */")]),t._v("\n    nextCurrentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" nextWorkInProgressHook\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ç¬¬ä¸€æ¬¡æ‰§è¡Œhooks")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œåº”è¯¥æ³¨æ„ä¸€ä¸‹ï¼Œå½“å‡½æ•°ç»„ä»¶æ›´æ–°ä¹Ÿæ˜¯è°ƒç”¨ renderWithHooks ,memoizedStateå±æ€§æ˜¯ç½®ç©ºçš„")]),t._v("\n    nextWorkInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    nextWorkInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextWorkInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* è¿™ä¸ªæƒ…å†µè¯´æ˜ renderWithHooks æ‰§è¡Œ è¿‡ç¨‹å‘ç”Ÿå¤šæ¬¡å‡½æ•°ç»„ä»¶çš„æ‰§è¡Œ ï¼Œæˆ‘ä»¬æš‚æ—¶å…ˆä¸è€ƒè™‘ */")]),t._v("\n    workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextWorkInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nextWorkInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    currentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextCurrentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("invariant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      nextCurrentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Rendered more hooks than during the previous render.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    currentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextCurrentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//åˆ›å»ºä¸€ä¸ªæ–°çš„hook")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("memoizedState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("baseState")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("baseQueue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("queue")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªhooks")]),t._v("\n      currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é‡æ–°æ›´æ–° hook")]),t._v("\n      workInProgressHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" workInProgressHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è¿™ä¸€æ®µçš„é€»è¾‘å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("é¦–å…ˆå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œ"),s("code",[t._v("hooks")]),t._v("å‡½æ•°ï¼Œé‚£ä¹ˆä»"),s("code",[t._v("current")]),t._v("æ ‘ä¸Šå–å‡º"),s("code",[t._v("memoizedState")]),t._v(" ï¼Œä¹Ÿå°±æ˜¯æ—§çš„"),s("code",[t._v("hooks")]),t._v("ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("ç„¶åå£°æ˜å˜é‡"),s("code",[t._v("nextWorkInProgressHook")]),t._v("ï¼Œè¿™é‡Œåº”è¯¥å€¼å¾—æ³¨æ„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€æ¬¡"),s("code",[t._v("renderWithHooks")]),t._v("æ‰§è¡Œï¼Œ"),s("code",[t._v("workInProgress")]),t._v("ä¸Šçš„"),s("code",[t._v("memoizedState")]),t._v("ä¼šè¢«ç½®ç©ºï¼Œ"),s("code",[t._v("hooks")]),t._v("å‡½æ•°é¡ºåºæ‰§è¡Œï¼Œ"),s("code",[t._v("nextWorkInProgressHook")]),t._v("åº”è¯¥ä¸€ç›´ä¸º"),s("code",[t._v("null")]),t._v("ï¼Œé‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹"),s("code",[t._v("nextWorkInProgressHook")]),t._v("ä¸ä¸º"),s("code",[t._v("null")]),t._v(",ä¹Ÿå°±æ˜¯å½“ä¸€æ¬¡"),s("code",[t._v("renderWithHooks")]),t._v("æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†å¤šæ¬¡å‡½æ•°ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯åœ¨"),s("code",[t._v("renderWithHooks")]),t._v("ä¸­è¿™æ®µé€»è¾‘ã€‚")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ....è¿™é‡Œçš„é€»è¾‘æˆ‘ä»¬å…ˆæ”¾ä¸€æ”¾  }")]),t._v("\n")])])])])]),t._v(" "),s("p",[t._v("è¿™é‡Œé¢çš„é€»è¾‘ï¼Œå®é™…å°±æ˜¯åˆ¤å®šï¼Œå¦‚æœå½“å‰å‡½æ•°ç»„ä»¶æ‰§è¡Œåï¼Œå½“å‰å‡½æ•°ç»„ä»¶çš„è¿˜æ˜¯å¤„äºæ¸²æŸ“ä¼˜å…ˆçº§ï¼Œè¯´æ˜å‡½æ•°ç»„ä»¶åˆæœ‰äº†æ–°çš„æ›´æ–°ä»»åŠ¡ï¼Œé‚£ä¹ˆå¾ªåæ‰§è¡Œå‡½æ•°ç»„ä»¶ã€‚è¿™å°±é€ æˆäº†ä¸Šè¿°çš„ï¼Œ"),s("code",[t._v("nextWorkInProgressHook")]),t._v("ä¸ä¸º "),s("code",[t._v("null")]),t._v(" çš„æƒ…å†µã€‚")]),t._v(" "),s("ul",[s("li",[t._v("æœ€åå¤åˆ¶"),s("code",[t._v("current")]),t._v("çš„"),s("code",[t._v("hooks")]),t._v("ï¼ŒæŠŠå®ƒèµ‹å€¼ç»™"),s("code",[t._v("workInProgressHook")]),t._v(",ç”¨äºæ›´æ–°æ–°çš„ä¸€è½®"),s("code",[t._v("hooks")]),t._v("çŠ¶æ€ã€‚")])]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹å››ä¸ªç§ç±»çš„"),s("code",[t._v("hooks")]),t._v("ï¼Œåœ¨ä¸€æ¬¡ç»„ä»¶æ›´æ–°ä¸­ï¼Œåˆ†åˆ«åšäº†é‚£äº›æ“ä½œã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-updatestate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-updatestate"}},[t._v("#")]),t._v(" 2 updateState")]),t._v(" "),s("p",[s("strong",[t._v("useState")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateReducer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("reducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  initialArg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" queue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastRenderedReducer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" reducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" baseQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pendingQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pendingQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œçœç•¥... ç¬¬ä¸€æ­¥ï¼šå°† pending  queue åˆå¹¶åˆ° basequeue")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("baseQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" first "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" baseQueue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newBaseState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newBaseQueueFirst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" first"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" updateExpirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("updateExpirationTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" renderExpirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ä¼˜å…ˆçº§ä¸è¶³")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" clone  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("expirationTime")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expirationTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          newBaseQueueFirst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          newBaseState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseQueueLast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æ­¤æ›´æ–°ç¡®å®å…·æœ‰è¶³å¤Ÿçš„ä¼˜å…ˆçº§ã€‚")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("expirationTime")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Sync"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n             "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseQueueLast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clone"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* å¾—åˆ°æ–°çš„ state */")]),t._v("\n        newState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reducer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      update "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("update "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" first"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newBaseQueueLast "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      newBaseState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      newBaseQueueLast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseQueueFirst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseQueue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newBaseQueueLast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastRenderedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dispatch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è¿™ä¸€æ®µçœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œè®©æˆ‘ä»¬æ…¢æ…¢åƒé€ï¼Œé¦–å…ˆå°†ä¸Šä¸€æ¬¡æ›´æ–°çš„"),s("code",[t._v("pending queue")]),t._v(" åˆå¹¶åˆ° "),s("code",[t._v("basequeue")]),t._v("ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶ä¸­è¿™ä¹ˆå†™ï¼Œ")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" number "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("setNumber "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handerClick")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    setNumber(1)")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    setNumber(2)")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    setNumber(3)")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNumber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–ä¸Šæ¬¡ state = 1 ")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNumber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–ä¸Šæ¬¡ state = 2")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNumber")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3 ")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" number "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handerClick")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("ç‚¹å‡»"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("ç‚¹å‡»æŒ‰é’®ï¼Œ æ‰“å° 3")])]),t._v(" "),s("p",[t._v("ä¸‰æ¬¡"),s("code",[t._v("setNumber")]),t._v("äº§ç”Ÿçš„"),s("code",[t._v("update")]),t._v("ä¼šæš‚ä¸”æ”¾å…¥"),s("code",[t._v("pending queue")]),t._v("ï¼Œåœ¨ä¸‹ä¸€æ¬¡å‡½æ•°ç»„ä»¶æ‰§è¡Œæ—¶å€™ï¼Œä¸‰æ¬¡ "),s("code",[t._v("update")]),t._v("è¢«åˆå¹¶åˆ° "),s("code",[t._v("baseQueue")]),t._v("ã€‚ç»“æ„å¦‚ä¸‹å›¾ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9vwXvsCcoplj6QDeCF87W4UsmHT8WfbUoV7V6LUCJ7hJrBOib9gw2cvQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥ä¼šæŠŠå½“å‰"),s("code",[t._v("useState")]),t._v("æˆ–æ˜¯"),s("code",[t._v("useReduer")]),t._v("å¯¹åº”çš„"),s("code",[t._v("hooks")]),t._v("ä¸Šçš„"),s("code",[t._v("baseState")]),t._v("å’Œ"),s("code",[t._v("baseQueue")]),t._v("æ›´æ–°åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚ä¼šå¾ªç¯"),s("code",[t._v("baseQueue")]),t._v("çš„"),s("code",[t._v("update")]),t._v("ï¼Œå¤åˆ¶ä¸€ä»½"),s("code",[t._v("update")]),t._v(",æ›´æ–° "),s("code",[t._v("expirationTime")]),t._v("ï¼Œå¯¹äºæœ‰è¶³å¤Ÿä¼˜å…ˆçº§çš„"),s("code",[t._v("update")]),t._v("ï¼ˆä¸Šè¿°ä¸‰ä¸ª"),s("code",[t._v("setNumber")]),t._v("äº§ç”Ÿçš„"),s("code",[t._v("update")]),t._v("éƒ½å…·æœ‰è¶³å¤Ÿçš„ä¼˜å…ˆçº§ï¼‰ï¼Œæˆ‘ä»¬è¦è·å–æœ€æ–°çš„"),s("code",[t._v("state")]),t._v("çŠ¶æ€ã€‚ï¼Œä¼šä¸€æ¬¡æ‰§è¡Œ"),s("code",[t._v("useState")]),t._v("ä¸Šçš„æ¯ä¸€ä¸ª"),s("code",[t._v("action")]),t._v("ã€‚å¾—åˆ°æœ€æ–°çš„"),s("code",[t._v("state")]),t._v("ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("æ›´æ–°state")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9K7HjGf6G85JRwTic19FwibN9VqXCwjiaMPwrIniccPlwDm9jtibKG9ghZqQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("è¿™é‡Œæœ‰ä¼šæœ‰ä¸¤ä¸ªç–‘é—®ğŸ¤”ï¸:")]),t._v(" "),s("ul",[s("li",[t._v("é—®é¢˜ä¸€ï¼šè¿™é‡Œä¸æ˜¯æ‰§è¡Œæœ€åä¸€ä¸ª"),s("code",[t._v("action")]),t._v("ä¸å°±å¯ä»¥äº†å˜›?")])]),t._v(" "),s("p",[t._v("ç­”æ¡ˆï¼šåŸå› å¾ˆç®€å•ï¼Œä¸Šé¢è¯´äº† "),s("code",[t._v("useState")]),t._v("é€»è¾‘å’Œ"),s("code",[t._v("useReducer")]),t._v("å·®ä¸å¤šã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šå¼•ç”¨ä¸Šä¸€æ¬¡ "),s("code",[t._v("update")]),t._v("äº§ç”Ÿçš„ "),s("code",[t._v("state")]),t._v(", æ‰€ä»¥éœ€è¦"),s("strong",[t._v("å¾ªç¯è°ƒç”¨ï¼Œæ¯ä¸€ä¸ª"),s("code",[t._v("update")]),t._v("çš„"),s("code",[t._v("reducer")])]),t._v("ï¼Œå¦‚æœ"),s("code",[t._v("setNumber(2)")]),t._v("æ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆåªç”¨æ›´æ–°å€¼ï¼Œå¦‚æœæ˜¯"),s("code",[t._v("setNumber(state=>state+1)")]),t._v(",é‚£ä¹ˆä¼ å…¥ä¸Šä¸€æ¬¡çš„ "),s("code",[t._v("state")]),t._v(" å¾—åˆ°æœ€æ–°"),s("code",[t._v("state")]),t._v("ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("é—®é¢˜äºŒï¼šä»€ä¹ˆæƒ…å†µä¸‹ä¼šæœ‰ä¼˜å…ˆçº§ä¸è¶³çš„æƒ…å†µ("),s("code",[t._v("updateExpirationTime < renderExpirationTime")]),t._v(")ï¼Ÿ")])]),t._v(" "),s("p",[t._v("ç­”æ¡ˆï¼šè¿™ç§æƒ…å†µï¼Œä¸€èˆ¬ä¼šå‘ç”Ÿåœ¨ï¼Œå½“æˆ‘ä»¬è°ƒç”¨"),s("code",[t._v("setNumber")]),t._v("æ—¶å€™ï¼Œè°ƒç”¨"),s("code",[t._v("scheduleUpdateOnFiber")]),t._v("æ¸²æŸ“å½“å‰ç»„ä»¶æ—¶ï¼Œåˆäº§ç”Ÿäº†ä¸€æ¬¡æ–°çš„æ›´æ–°ï¼Œæ‰€ä»¥æŠŠæœ€ç»ˆæ‰§è¡Œ"),s("code",[t._v("reducer")]),t._v("æ›´æ–°"),s("code",[t._v("state")]),t._v("ä»»åŠ¡äº¤ç»™ä¸‹ä¸€æ¬¡æ›´æ–°ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_3-updateeffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-updateeffect"}},[t._v("#")]),t._v(" 3 updateEffect")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" destroy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentHook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentHook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    destroy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prevEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("destroy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prevEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("areHookInputsEqual")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prevDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hookEffectTag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" destroy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  currentlyRenderingFiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectTag "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|=")]),t._v(" fiberEffectTag\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    HookHasEffect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" hookEffectTag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    destroy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("useEffect")]),t._v(" åšçš„äº‹å¾ˆç®€å•ï¼Œåˆ¤æ–­ä¸¤æ¬¡"),s("code",[t._v("deps")]),t._v(" ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰è¯´æ˜æ­¤æ¬¡æ›´æ–°ä¸éœ€è¦æ‰§è¡Œï¼Œåˆ™ç›´æ¥è°ƒç”¨ "),s("code",[t._v("pushEffect")]),t._v(",è¿™é‡Œæ³¨æ„ "),s("code",[t._v("effect")]),t._v("çš„æ ‡ç­¾ï¼Œ"),s("code",[t._v("hookEffectTag")]),t._v(",å¦‚æœä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆæ›´æ–° "),s("code",[t._v("effect")]),t._v(" ,å¹¶ä¸”èµ‹å€¼ç»™"),s("code",[t._v("hook.memoizedState")]),t._v("ï¼Œè¿™é‡Œæ ‡ç­¾æ˜¯ "),s("code",[t._v("HookHasEffect | hookEffectTag")]),t._v(",ç„¶ååœ¨"),s("code",[t._v("commit")]),t._v("é˜¶æ®µï¼Œ"),s("code",[t._v("react")]),t._v("ä¼šé€šè¿‡æ ‡ç­¾æ¥åˆ¤æ–­ï¼Œæ˜¯å¦æ‰§è¡Œå½“å‰çš„ "),s("code",[t._v("effect")]),t._v(" å‡½æ•°ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_4-updatememo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-updatememo"}},[t._v("#")]),t._v(" 4 updateMemo")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateMemo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" deps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–°çš„ deps å€¼")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prevState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevDeps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prevState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¹‹å‰ä¿å­˜çš„ deps å€¼")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("areHookInputsEqual")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prevDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//åˆ¤æ–­ä¸¤æ¬¡ deps å€¼")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" prevState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" nextValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nextValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextDeps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nextValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åœ¨ç»„ä»¶æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œ"),s("code",[t._v("useMemo")]),t._v("å‡½æ•°ï¼Œåšçš„äº‹æƒ…å®é™…å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ¤æ–­ä¸¤æ¬¡ "),s("code",[t._v("deps")]),t._v("æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸æƒ³ç­‰ï¼Œè¯æ˜ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæ‰§è¡Œ "),s("code",[t._v("useMemo")]),t._v("çš„ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œå¾—åˆ°æ–°çš„å€¼ï¼Œç„¶åé‡æ–°èµ‹å€¼ç»™"),s("code",[t._v("hook.memoizedState")]),t._v(",å¦‚æœç›¸ç­‰ è¯æ˜æ²¡æœ‰ä¾èµ–é¡¹æ”¹å˜ï¼Œé‚£ä¹ˆç›´æ¥è·å–ç¼“å­˜çš„å€¼ã€‚")]),t._v(" "),s("p",[t._v("ä¸è¿‡è¿™é‡Œæœ‰ä¸€ç‚¹ï¼Œå€¼å¾—æ³¨æ„ï¼Œ"),s("code",[t._v("nextCreate()")]),t._v("æ‰§è¡Œï¼Œå¦‚æœé‡Œé¢å¼•ç”¨äº†"),s("code",[t._v("usestate")]),t._v("ç­‰ä¿¡æ¯ï¼Œå˜é‡ä¼šè¢«å¼•ç”¨ï¼Œæ— æ³•è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼Œå°±æ˜¯é—­åŒ…åŸç†ï¼Œé‚£ä¹ˆè®¿é—®çš„å±æ€§æœ‰å¯èƒ½ä¸æ˜¯æœ€æ–°çš„å€¼ï¼Œæ‰€ä»¥éœ€è¦æŠŠå¼•ç”¨çš„å€¼ï¼Œæ·»åŠ åˆ°ä¾èµ–é¡¹ "),s("code",[t._v("dep")]),t._v(" æ•°ç»„ä¸­ã€‚æ¯ä¸€æ¬¡"),s("code",[t._v("dep")]),t._v("æ”¹å˜ï¼Œé‡æ–°æ‰§è¡Œï¼Œå°±ä¸ä¼šå‡ºç°é—®é¢˜äº†ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("æ¸©é¦¨å°æç¤ºï¼šæœ‰å¾ˆå¤šåŒå­¦è¯´ "),s("code",[t._v("useMemo")]),t._v("æ€ä¹ˆç”¨ï¼Œåˆ°åº•ä»€ä¹ˆåœºæ™¯ç”¨ï¼Œç”¨äº†ä¼šä¸ä¼šèµ·åˆ°åä½œç”¨ï¼Œé€šè¿‡å¯¹æºç åŸç†è§£æï¼Œæˆ‘å¯ä»¥æ˜ç¡®çš„è¯´ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ”¾å¿ƒä½¿ç”¨ï¼Œè¯´ç™½äº†å°±æ˜¯å¯ä»¥å®šåˆ¶åŒ–ç¼“å­˜ï¼Œå­˜å€¼å–å€¼è€Œå·²ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_5-updateref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-updateref"}},[t._v("#")]),t._v(" 5 updateRef")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWorkInProgressHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memoizedState\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å‡½æ•°ç»„ä»¶æ›´æ–°useRefåšçš„äº‹æƒ…æ›´ç®€å•ï¼Œå°±æ˜¯è¿”å›äº†ç¼“å­˜ä¸‹æ¥çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æ— è®ºå‡½æ•°ç»„ä»¶æ€ä¹ˆæ‰§è¡Œï¼Œæ‰§è¡Œå¤šå°‘æ¬¡ï¼Œ"),s("code",[t._v("hook.memoizedState")]),t._v("å†…å­˜ä¸­éƒ½æŒ‡å‘äº†ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è§£é‡Šäº†"),s("code",[t._v("useEffect")]),t._v(","),s("code",[t._v("useMemo")]),t._v(" ä¸­ï¼Œä¸ºä»€ä¹ˆ"),s("code",[t._v("useRef")]),t._v("ä¸éœ€è¦ä¾èµ–æ³¨å…¥ï¼Œå°±èƒ½è®¿é—®åˆ°æœ€æ–°çš„æ”¹å˜å€¼ã€‚")]),t._v(" "),s("h2",{attrs:{id:"ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶æ›´æ–°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶æ›´æ–°"}},[t._v("#")]),t._v(" ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶æ›´æ–°")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/2KticQlBJtdx8qFekwZcicez5AIibeMzZf9Xte0iaxFJbKFFE9GaSu3xUkMMWjcvH8NOnEY9adx6ggxCibQt178q7HA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h1",{attrs:{id:"äº”-æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº”-æ€»ç»“"}},[t._v("#")]),t._v(" äº” æ€»ç»“")]),t._v(" "),s("p",[t._v("ä¸Šé¢æˆ‘ä»¬ä»"),s("strong",[t._v("å‡½æ•°ç»„ä»¶åˆå§‹åŒ–")]),t._v("ï¼Œåˆ°"),s("strong",[t._v("å‡½æ•°ç»„ä»¶æ›´æ–°æ¸²æŸ“")]),t._v("ï¼Œä¸¤ä¸ªç»´åº¦åˆ†è§£è®²è§£äº†"),s("code",[t._v("react-hooks")]),t._v("åŸç†ï¼ŒæŒæ¡äº†"),s("code",[t._v("react-hooks")]),t._v("åŸç†å’Œå†…éƒ¨è¿è¡Œæœºåˆ¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬åœ¨å·¥ä½œä¸­ï¼Œæ›´å¥½çš„ä½¿ç”¨"),s("code",[t._v("react-hooks")]),t._v("ã€‚")])])}),[],!1,null,null,null);s.default=n.exports}}]);