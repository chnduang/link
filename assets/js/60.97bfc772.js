(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{352:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"å‰ç«¯è¿ç»´éƒ¨ç½²é‚£äº›äº‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰ç«¯è¿ç»´éƒ¨ç½²é‚£äº›äº‹"}},[t._v("#")]),t._v(" å‰ç«¯è¿ç»´éƒ¨ç½²é‚£äº›äº‹")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/2-DIsGx9rKNxdRyYBFTv9w",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mp.weixin.qq.com/s/2-DIsGx9rKNxdRyYBFTv9w"),s("OutboundLink")],1)])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("èŠåˆ°è¿ç»´ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´æˆ‘è§‰å¾—è·Ÿå‰ç«¯å°±æ˜¯æ¯«æ— å…³è”çš„ç©æ„ï¼Œåº”è¯¥è¯´åŠæ¯›é’±å…³ç³»éƒ½æœ¨ã€‚ä½†éšç€å‰ç«¯å·¥ç¨‹åŒ–çš„å‘å±•ï¼Œå‰ç«¯åŸºæœ¬è¿ç»´éƒ¨ç½²ç›¸å…³çŸ¥è¯†ç”šè‡³ä¹Ÿé€æ­¥è¢«é‡è§†ï¼Œå¦‚æœä½ å…¬å¸çš„è¿ç»´éƒ¨é—¨å¾ˆå¼ºå¤§ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥å®Œå…¨å¿½ç•¥è¿ç»´ç›¸å…³çš„ã€‚åªæ˜¯æ ‘é…±è§‰å¾—ï¼Œå¦‚æœä½ æƒ³æ›´å¤šäº†è§£å‰ç«¯æ¶æ„ï¼Œè¿˜æ˜¯éœ€è¦å…·å¤‡ä¸€å®šçš„è¿ç»´ç›¸å…³çŸ¥è¯†å‚¨å¤‡ã€‚å½“ç„¶ï¼Œç°åœ¨äº‘å‚å•†éƒ½æƒ³åº”æ¨å‡ºè‡ªå·±çš„ServerlessæœåŠ¡(ä¸‹ä¸€ç¯‡ä¼šè®²ï½)ï¼Œå·ç§°è®©å‰ç«¯æ›´ä¸“æ³¨ä¸šåŠ¡çš„å¼€å‘ï¼Œè€Œä¸ç”¨æ‹…å¿ƒåº•å±‚åº”ç”¨çš„éƒ¨ç½²å’Œç»´æŠ¤ï¼Œå¯¹å¼€å‘è€…è€Œè¨€å¯ä»¥æ›´å¤šèšç„¦åˆ°ä¸šåŠ¡é¢†åŸŸçš„å¼€å‘ï¼Œæœ‰å…´è¶£çš„ç«¥é‹å¯ä»¥å»ç©ç©")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCKYibfFPCh90jh87WLWneqJHOXKeacibagaOvNmzcZUYC7ubnlq30G2Qw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h3",{attrs:{id:"_1-npm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-npm"}},[t._v("#")]),t._v(" 1.npm")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("npm æ˜¯ Node.js å®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œä¸»è¦ç”¨æ¥ç®¡ç†é¡¹ç›®ä¾èµ–ï¼Œå‘å¸ƒç­‰ç­‰ï¼Œä¸‹é¢ä»‹ç»å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²åº”ç”¨åœºæ™¯ï¼Œå¸¸ç”¨çš„npmå‘½ä»¤è¿™é‡Œä¸ä½œä»‹ç»äº†")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("h4",{attrs:{id:"_1-1-nrm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-nrm"}},[t._v("#")]),t._v(" 1.1 nrm")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("nrm(npm registry manager )æ˜¯npmçš„é•œåƒæºç®¡ç†å·¥å…·ï¼Œå› ä¸ºnpmé»˜è®¤å»ºç«‹çš„é“¾æ¥è®¿é—®çš„æ˜¯å›½å¤–çš„èµ„æºï¼Œè®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œä½¿ç”¨è¿™ä¸ªå°±å¯ä»¥å¿«é€Ÿåœ°åœ¨ npm æºé—´åˆ‡")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("ul",[s("li",[t._v("å¦‚ä½•å®‰è£…")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" nrm\n")])])]),s("ul",[s("li",[t._v("æŸ¥çœ‹å¯é€‰çš„èµ„æº")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nrm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("   \n\n*npm ---- https://registry.npmjs.org/\n\ncnpm --- http://r.cnpmjs.org/\n\ntaobao - http://registry.npm.taobao.org/\n\neu ----- http://registry.npmjs.eu/\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("ul",[s("li",[t._v("æ·»åŠ ç§æœ‰ä»“åº“é“¾æ¥")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nrm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" name http://registry.npm.tree.com/  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç§æœ‰ä»“åº“é“¾æ¥")]),t._v("\nnrm use name "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½¿ç”¨æœ¬å€çš„é•œåƒåœ°å€")]),t._v("\n")])])]),s("p",[t._v("nrm æ›´å¤šç”¨äºå¦‚æœå…¬å¸å†…ç½‘éƒ¨ç½²äº†ç§æœ‰ä»“åº“ï¼Œä¹Ÿå°±æ˜¯æ–¹ä¾¿ç”¨nrmä½œæ¥æºåˆ‡æ¢ï¼Œä¹Ÿæœ‰ç›Šäºä¾èµ–çš„ç‰ˆæœ¬ç®¡ç†ï¼Œå¦‚æœä½ æƒ³æ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“ï¼Œå¯ä»¥ä½¿ç”¨verdaccioï¼Œå¯ä»¥çœ‹è¿™ä¸ªå…·ä½“çš„æ•™ç¨‹ ç‚¹æˆ‘")]),t._v(" "),s("h4",{attrs:{id:"_1-2-å‘å¸ƒnpmåŒ…"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-å‘å¸ƒnpmåŒ…"}},[t._v("#")]),t._v(" 1.2 å‘å¸ƒnpmåŒ…")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("å½“æˆ‘ä»¬æƒ³å‘å¸ƒä¸€ä¸ªnpmåŒ…ï¼Œéœ€è¦å®Œæˆä»€ä¹ˆæ ·çš„æµç¨‹å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("ul",[s("li",[t._v("å…ˆæ³¨å†Œnpmè´¦å· ğŸ”—")]),t._v(" "),s("li",[t._v("é…ç½®package.json")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kutil"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" #ç‰ˆæœ¬åç§°\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" # å¯æ‰§è¡Œçš„è„šæœ¬å‘½ä»¤\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"repository"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/xxx/xxx.git"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" #githubä»“åº“åœ°å€\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"author"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tree <shuxin_liu@kingdee.com>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" #ä½œè€…\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(' "å·¥å…·åŒ…â€œ'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" #åŒ…çš„è¯´æ˜\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"keywords"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utils"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("é…ç½®æ‰“åŒ…æœºåˆ¶")])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("å¦‚æœæ˜¯å·¥å…·ç±»æ‰“åŒ…ï¼Œæ¨èä½¿ç”¨rollupï¼Œwebpackæ¯”è¾ƒé€‚åˆæ‰“åŒ…ä¸€äº›åº”ç”¨ï¼Œä¾‹å¦‚SPAæˆ–è€…åŒæ„é¡¹ç›®")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("ul",[s("li",[t._v("æ·»åŠ å•å…ƒæµ‹è¯•")])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("ä¼˜è´¨çš„å¼€æºåŒ…ï¼Œéƒ½æœ‰å•å…ƒæµ‹è¯•æ¨¡å—ï¼Œæ¥ä¿è¯åŒ…çš„ç¨³å®šæ€§å’Œä»£ç è´¨é‡ï¼Œå¸¸è§ä¼šæœ‰build-passingçš„æ ‡è®°ï¼Œæœ‰å…´è¶£çš„ç«¥é‹å¯ä»¥é˜…è¯»æ ‘é…±ä¹‹å‰å†™çš„å‰ç«¯å•å…ƒæµ‹è¯•é‚£äº›äº‹")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("ul",[s("li",[t._v("å¼€å‘æ–‡æ¡£readme.me")])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("readmeæ–¹ä¾¿å¼€å‘è€…å¿«é€Ÿç†Ÿæ‚‰ï¼ŒåŒ…æ‹¬å…·ä½“çš„Apiä»‹ç»ã€ä½¿ç”¨ä¾‹å­ã€é¡¹ç›®ä»‹ç»ç­‰ç­‰ï¼Œè¿˜å¯ä»¥åŠ å…¥åŒ…æ‹¬å•å…ƒæµ‹è¯•è¦†ç›–ç‡ã€ä¸‹è½½é‡ã€è¯ä¹¦ç­‰ç­‰")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("p",[t._v("æœ€åå®Œæˆä¸Šé¢ä¸€ç³»åˆ—æ“ä½œä¹‹åï¼Œåˆ°äº†æœ€ç»ˆçš„å‘å¸ƒç¯èŠ‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" login "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç™»å½•ä½ ä¸Šé¢æ³¨å†Œçš„npmè´¦å·")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" publish "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç™»å½•æˆåŠŸåï¼Œæ‰§è¡Œå‘å¸ƒå‘½ä»¤")]),t._v("\n\n+ kutil@1.0.0 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‘å¸ƒæˆåŠŸæ˜¾ç¤ºnpmæŠ¥ååŠåŒ…çš„ç‰ˆæœ¬å·")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-jenkins"}},[t._v("#")]),t._v(" 2. jenkins")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("jenkinsä½œä¸ºä¸€ä¸ªå¯æ‰©å±•çš„è‡ªåŠ¨åŒ–æœåŠ¡å™¨ï¼Œå¯ä»¥ç”¨ä½œç®€å•çš„ CI æœåŠ¡å™¨ï¼Œå…·æœ‰è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ç­‰åŠŸèƒ½ï¼Œç®€è€Œè¨€ä¹‹ï¼Œjenkinså¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ—¥å¸¸çš„å‰ç«¯é¡¹ç›®ç‰ˆæœ¬æ›´æ–°è¿­ä»£ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒè‡ªåŠ¨åŒ–å®Œæˆä¸€ç³»åˆ—çš„æ“ä½œåŒ…æ‹¬ï¼šç¼–è¯‘æ‰“åŒ…å…ƒæµ‹è¯•ã€ä»£ç æ‰«æç­‰ï¼Œå®˜æ–¹æ–‡æ¡£")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("h4",{attrs:{id:"_2-1-å¦‚ä½•å®‰è£…"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-å¦‚ä½•å®‰è£…"}},[t._v("#")]),t._v(" 2.1 å¦‚ä½•å®‰è£…")]),t._v(" "),s("ul",[s("li",[t._v("ä¸‹è½½ Jenkins.")]),t._v(" "),s("li",[t._v("æ‰“å¼€ç»ˆç«¯è¿›å…¥åˆ°ä¸‹è½½ç›®å½•.")]),t._v(" "),s("li",[t._v("è¿è¡Œå‘½ä»¤ "),s("code",[t._v("java -jar jenkins.war --httpPort=8080.")])]),t._v(" "),s("li",[t._v("æ‰“å¼€æµè§ˆå™¨è¿›å…¥é“¾æ¥ http://localhost:8080.")]),t._v(" "),s("li",[t._v("æŒ‰ç…§è¯´æ˜å®Œæˆå®‰è£….")])]),t._v(" "),s("p",[t._v("è¯¦ç»†æµç¨‹å›¾å¯å‚è€ƒ Jenkins+github å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("h4",{attrs:{id:"_2-2-é…åˆå‰ç«¯é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-é…åˆå‰ç«¯é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[t._v("#")]),t._v(" 2.2 é…åˆå‰ç«¯é¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("è¿™é‡Œä¸»è¦ä»‹ç»jenkinsæµæ°´çº¿é…ç½®çš„ä½¿ç”¨ï¼Œæµæ°´çº¿çš„ä»£ç å®šä¹‰äº†æ•´ä¸ªçš„æ„å»ºè¿‡ç¨‹, ä»–é€šå¸¸åŒ…æ‹¬æ„å»º, æµ‹è¯•å’Œäº¤ä»˜åº”ç”¨ç¨‹åºçš„é˜¶æ®µï¼Œä¸‹é¢æ˜¯è·¯å¾„å’Œä»“åº“çš„é…ç½®")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PC1cQc9Ml1KicnVEcshLSTCJJVM4kBRzWuv5ySP2EKksERxulCEib3TtFg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å›¾ç‰‡ç›¸å…³é…ç½®å¦‚ä¸‹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("SCM:é€‰æ‹©gitæˆ–è€…svnä½œä¸ºä»£ç è§¦å‘å™¨")]),t._v(" "),s("li",[t._v("è„šæœ¬è·¯å¾„ï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºjenkinsfileæ¥ç¼–å†™æµæ°´çº¿")])]),t._v(" "),s("p",[t._v("ä¸‹é¢ä»‹ç»ä¸€ä¸ªç®€å•ç‰ˆçš„jenkinsfileçš„æµæ°´çº¿ä»»åŠ¡å†™æ³•ï¼Œå®Œæˆæ•´ä¸ªå‰ç«¯å·¥ç¨‹åŒ–éƒ¨ç½²æ¶‰åŠçš„ç¼–è¯‘æ‰“åŒ…ã€é™æ€æ‰«æã€å•å…ƒæµ‹è¯•ç­‰ç¯èŠ‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("def gitUrl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://gitlab.****.com/shc/****.git"')]),t._v("//GITå…¥å£ï¼ˆéšä¸åŒå·¥ç¨‹æ”¹å˜ï¼‰\ndef gitCred "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"***-***-4f00-a926-1848b670d97b"')]),t._v("    //GIT èº«ä»½å‡­æ®\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DEV"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" buildType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    buildScript "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build_development"')]),t._v("\n    try "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'k8s'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            stage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¸‹æ‹‰æºç '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                   checkout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$class")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GitSCM'")]),t._v(", branches: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*/master'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", doGenerateSubmoduleConfigurations: false, extensions: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", submoduleCfg: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", userRemoteConfigs: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("credentialsId: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${gitCred}")]),t._v('"')]),t._v(", url: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${gitUrl}")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#å¯ç”±ç‰‡æ®µç”Ÿæˆå™¨ç”Ÿæˆï¼Œé€‰æ‹©ç¤ºä¾‹æ­¥éª¤ â€œcheckout:Check out from version controlâ€ï¼Œç”Ÿæˆæµæ°´çº¿è„šæœ¬è·å–")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            checkStatus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¸‹æ‹‰æºç '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            stage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä»£ç æ„å»ºç¼–è¯‘'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn run '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${buildScript}")]),t._v('"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            checkStatus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä»£ç æ„å»ºç¼–è¯‘'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            stage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä»£ç é™æ€æ‰«æ'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yarn run lint'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            checkStatus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä»£ç é™æ€æ‰«æ'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            stage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'å•å…ƒæµ‹è¯•'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yarn run unit'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            checkStatus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'å•å…ƒæµ‹è¯•'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" catch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Exception e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å®Œæˆåï¼Œå³å¯æ„å»ºé¡¹ç›®ï¼Œåˆ†é˜¶æ®µå®Œæˆï¼Œé¦–å…ˆæ˜¯ä¸‹æ‹‰æºç ã€ä»£ç æ„å»ºç¼–è¯‘ã€ä»£ç æ‰«æç­‰ç­‰ï¼Œæ‰€æœ‰ç¯èŠ‚æˆåŠŸæ‰ç®—è‡ªåŠ¨åŒ–éƒ¨ç½²æˆåŠŸï¼Œå¦‚ä¸‹æ‰€ç¤º")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCdwCJZHvjHspD1pk9QoetxhuYMHK5L4WKefwVWEILibc6lelnPUtUD3A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h3",{attrs:{id:"_3-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker"}},[t._v("#")]),t._v(" 3.Docker")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("Dockeræ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒå®¹å™¨,å¯ä»¥å°†å¼€å‘ç¯å¢ƒã€ä»£ç ã€é…ç½®æ–‡ä»¶ç­‰ä¸€å¹¶æ‰“åŒ…åˆ°è¿™ä¸ªå®¹å™¨ä¸­,æœ€åå‘å¸ƒåº”ç”¨")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("h4",{attrs:{id:"_3-1-å¦‚ä½•ä½¿ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-å¦‚ä½•ä½¿ç”¨"}},[t._v("#")]),t._v(" 3.1 å¦‚ä½•ä½¿ç”¨")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("é€šè¿‡å°†éƒ¨ç½²çš„æ“ä½œé›†ä¸­æˆä¸€ä¸ªéƒ¨ç½²è„šæœ¬å®Œæˆä¼ ç»Ÿçš„éƒ¨ç½²æµç¨‹ï¼Œé€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œdockerå®¹å™¨æ¥è¿è¡Œå‰ç«¯åº”ç”¨")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("p",[t._v("å¦‚ä½•å®‰è£…")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" docker-ce\n")])])]),s("p",[t._v("é¡¹ç›®ç›®å½•ï¼Œéƒ¨ç½²é¡¹ç›®éœ€è¦å‡†å¤‡Dockerfileå’Œnginx.conf(å¦‚æœnginxä¸ä½œå®šåˆ¶åŒ–ï¼Œå¯ä»¥ç›´æ¥ç”¨å®˜æ–¹é•œåƒ)")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PChmIuNhcpbOTv0mibmPa9e3lwcNlE1lkEzia3g5Qj5qTPY2kHcpTia643g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h4",{attrs:{id:"_3-2-dockerfile-é…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-dockerfile-é…ç½®"}},[t._v("#")]),t._v(" 3.2 Dockerfile é…ç½®")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("dockerfileæ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶,ç”¨æ¥è®©docker buildå‘½ä»¤æ¸…æ¥šè¿è¡Œé‚£äº›æ“ä½œï¼Œåˆ›å»ºdockerfileå¹¶ç¼–å†™ç›¸å…³é…ç½®")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("blockquote",[s("p",[t._v("æ¯ä¸€ä¸ªæŒ‡ä»¤çš„å‰ç¼€éƒ½å¿…é¡»æ˜¯å¤§å†™çš„")])]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" node:latest "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" builder ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /app")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" package.json ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm install   ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" . .")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm run build")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" nginx:latest")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" nginx.conf /etc/nginx")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token options"}},[s("span",{pre:!0,attrs:{class:"token property"}},[t._v("--from")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("builder")])]),t._v(" /app/dist  /usr/share/nginx/html")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 80")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("ADDå’ŒCOPY")]),t._v("ï¼š å°†æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°Dockerfileæ„å»ºçš„é•œåƒä¸­")]),t._v(" "),s("li",[s("code",[t._v("EXPOSE")]),t._v("ï¼š æŒ‡å®šè¿è¡Œè¯¥é•œåƒçš„å®¹å™¨ä½¿ç”¨çš„ç«¯å£ï¼Œå¯ä»¥æ˜¯å¤šä¸ªã€‚")]),t._v(" "),s("li",[s("code",[t._v("RUN")]),t._v(" ï¼šæŒ‡ä»¤å‘Šè¯‰docker åœ¨é•œåƒå†…æ‰§è¡Œå‘½ä»¤")]),t._v(" "),s("li",[s("code",[t._v("FROM")]),t._v(" ï¼šé€šè¿‡FROMæŒ‡å®šçš„é•œåƒåç§°ï¼Œè¿™ä¸ªé•œåƒç§°ä¹‹ä¸ºåŸºç¡€é•œåƒï¼Œå¿…é¡»ä½äºç¬¬ä¸€æ¡éæ³¨é‡ŠæŒ‡ä»¤")]),t._v(" "),s("li",[s("code",[t._v("WORKDIR")]),t._v("ï¼š åœ¨å®¹å™¨å†…éƒ¨è®¾ç½®å·¥ä½œç›®å½•")])]),t._v(" "),s("p",[s("code",[t._v("Nginx.conf")]),t._v(" é…ç½®å¦‚ä¸‹")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("events")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_connections")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  localhost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   /usr/share/nginx/html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html index.htm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åˆ›å»ºæ–‡ä»¶å¹¶ç¼–å†™åï¼Œç”¨dockeråˆ›å»ºé•œåƒ")]),t._v(" "),s("h4",{attrs:{id:"_3-3-å¦‚ä½•åˆ›å»ºé•œåƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-å¦‚ä½•åˆ›å»ºé•œåƒ"}},[t._v("#")]),t._v(" 3.3 å¦‚ä½•åˆ›å»ºé•œåƒ")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("ä½¿ç”¨å½“å‰ç›®å½•çš„ Dockerfile åˆ›å»ºé•œåƒï¼Œæ ‡ç­¾ä¸º frontend")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" frontend "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[s("code",[t._v("-t")]),t._v(" ï¼šæŒ‡å®šè¦åˆ›å»ºçš„ç›®æ ‡é•œåƒ")])]),t._v(" "),s("li",[s("p",[s("code",[t._v(".")]),t._v(" ï¼šDockerfile æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¯ä»¥æŒ‡å®šDockerfile çš„ç»å¯¹è·¯å¾„")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCKkCibqcxfpCrQ0Qr18xAvic9dRm8JtU7Wv6pcIXiahV8ZaMzTGZpZicuTw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCTQup8kuVPUj3gYBM2oibJmQV9v3LXC2YibaBmWGzUMK0pjoOFtFRZI2w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})])])]),t._v(" "),s("p",[t._v("é•œåƒæˆåŠŸç”Ÿæˆ")]),t._v(" "),s("h4",{attrs:{id:"_3-4-æŸ¥çœ‹é•œåƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-æŸ¥çœ‹é•œåƒ"}},[t._v("#")]),t._v(" 3.4 æŸ¥çœ‹é•œåƒ")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" frontend\n")])])]),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCL3Rd1GLk7g0C8dSbvaySlgyn7n7sVYMZib4RdMeNcWszMCxn6TxbLYA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å‡ºç°ç»“æœåˆ™åº”ç”¨é•œåƒ frontend æˆåŠŸåˆ›å»º,ç„¶åæˆ‘ä»¬åŸºäºè¯¥é•œåƒå¯åŠ¨ä¸€ä¸ªDockerå®¹å™¨")]),t._v(" "),s("h4",{attrs:{id:"_4-5-å¦‚ä½•å¯åŠ¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-å¦‚ä½•å¯åŠ¨"}},[t._v("#")]),t._v(" 4.5 å¦‚ä½•å¯åŠ¨")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("ä½¿ç”¨dockeré•œåƒfrontend:latestä»¥æŒ‡å®š80ç«¯å£æ˜ å°„æ¨¡å¼å¯åŠ¨å®¹å™¨,å¹¶å°†å®¹å™¨å‘½åä¸ºfrontend")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" frontend "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80 frontend:latest\n")])])]),s("ul",[s("li",[s("code",[t._v("-p")]),t._v(": æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£ å°†å®¿ä¸»çš„80ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„80ç«¯å£")]),t._v(" "),s("li",[s("code",[t._v("--name")]),t._v(": ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›")])]),t._v(" "),s("p",[t._v("å®Œæˆ "),s("code",[t._v("docker")]),t._v(" éƒ¨ç½²")]),t._v(" "),s("p",[s("code",[t._v("docker")]),t._v("ä¹Ÿå¯ä»¥é›†æˆåˆ°ä¸Šä¸€èŠ‚è®²çš„"),s("code",[t._v("jenkins")]),t._v("è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿ä¸­å»")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("  stage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'éƒ¨ç½²åˆ°å¼€å‘è”è°ƒç¯å¢ƒ'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auto deploy to test environment"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docker build -t frontend ."')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docker run --name frontend -p 80:80 frontend:latest"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-pm2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-pm2"}},[t._v("#")]),t._v(" 4.PM2")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("PM2æ˜¯nodeè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥ç®€åŒ–å¾ˆå¤šnodeåº”ç”¨ç®¡ä¸­ç¹çä»»åŠ¡ï¼Œæ˜¯Nodejsåº”ç”¨ç¨‹åºå®ˆæŠ¤è¿›ç¨‹å¿…ä¸å¯å°‘çš„é€‰æ‹©ï¼Œæ–¹ä¾¿ç®¡ç†åŸºäºnodejså¹³å°ä¸‹èƒ½å¤Ÿæœ‰ç‹¬ç«‹è¿è¡Œè®¿é—®çš„webæœåŠ¡ï¼Œå¦‚nextjsã€expressã€koaç­‰å‰ç«¯åº”ç”¨")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("h4",{attrs:{id:"_4-1-å¸¸è§çš„åº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-å¸¸è§çš„åº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" 4.1 å¸¸è§çš„åº”ç”¨åœºæ™¯")]),t._v(" "),s("ul",[s("li",[t._v("éƒ¨ç½²"),s("code",[t._v("node koa2")]),t._v("æˆ– "),s("code",[t._v("express")]),t._v("é¡¹ç›®åº”ç”¨")]),t._v(" "),s("li",[t._v("éƒ¨ç½² å‰ç«¯"),s("code",[t._v("SSR")]),t._v("ï¼ˆåç«¯æ¸²æŸ“ï¼‰åº”ç”¨ï¼Œå¦‚"),s("code",[t._v("nuxt.jsï¼ˆVueï¼‰")]),t._v("å’Œ"),s("code",[t._v("next.js(React)")]),t._v("ç­‰æ„å»ºæœåŠ¡ç«¯æ¸²æŸ“åº”ç”¨æ¡†æ¶")])]),t._v(" "),s("h4",{attrs:{id:"_4-2-å¦‚ä½•ä½¿ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-å¦‚ä½•ä½¿ç”¨"}},[t._v("#")]),t._v(" 4.2 å¦‚ä½•ä½¿ç”¨")]),t._v(" "),s("ul",[s("li",[t._v("å®‰è£… ï¼š"),s("code",[t._v("npm install -g pm2")])]),t._v(" "),s("li",[t._v("å¯åŠ¨nodeé¡¹ç›® : "),s("code",[t._v("pm2 start app.js æˆ–è€… pm2 start bin/www")])]),t._v(" "),s("li",[t._v("åœæ­¢pm2æœåŠ¡ï¼š"),s("code",[t._v("pm2 stop bin/www")])]),t._v(" "),s("li",[t._v("åœæ­¢æ‰€æœ‰pm2æœåŠ¡: "),s("code",[t._v("pm2 stop all")])]),t._v(" "),s("li",[t._v("é‡å¯pm2æœåŠ¡: "),s("code",[t._v("pm2 restart bin/www")])]),t._v(" "),s("li",[t._v("pm2æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼š"),s("code",[t._v("pm2 list")])])]),t._v(" "),s("p",[t._v("å¯åŠ¨åå¦‚ä¸‹æ‰€ç¤º")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PC9j1G4h6u3HU8Xt3p8tX5N65ImGxibxdtwPrPibGibBvibpD9Xtm9wbqLRg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h4",{attrs:{id:"_4-3-é«˜é˜¶åº”ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-é«˜é˜¶åº”ç”¨"}},[t._v("#")]),t._v(" 4.3 é«˜é˜¶åº”ç”¨")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªprocesses.json")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n #appsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªæ•°ç»„æˆå‘˜å°±æ˜¯å¯¹åº”ä¸€ä¸ªpm2ä¸­è¿è¡Œçš„åº”ç”¨\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"apps"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  #åç§°\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" #ç¨‹åºå…¥å£\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"cwd"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           #åº”ç”¨ç¨‹åºæ‰€åœ¨çš„ç›®å½•\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error_file"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./logs/err.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("#é”™è¯¯è¾“å‡ºæ—¥å¿—\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"log_date_format"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"YYYY-MM-DD HH:mm Z"')]),t._v(" #æ—¥æœŸæ ¼å¼\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("ç»“åˆ"),s("code",[t._v("package.json")]),t._v("è„šæœ¬å‘½ä»¤ï¼Œå¯ä»¥ç”¨"),s("code",[t._v("processes")]),t._v("æ¥ç®¡ç†å¤šåº”ç”¨")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pm2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pm2 start processes.json"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æ›´å¤šå‘½ä»¤å’Œé…ç½®ä¿¡æ¯æŸ¥çœ‹ pm2æ–‡æ¡£")]),t._v(" "),s("h3",{attrs:{id:"_5-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-nginx"}},[t._v("#")]),t._v(" 5.Nginx")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("Nginxå®ƒæ—¢å¯ä»¥ä½œä¸º Web æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œå…·å¤‡é«˜æ€§èƒ½ã€é«˜å¹¶å‘è¿æ¥ç­‰")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("h4",{attrs:{id:"_5-1-å‰ç«¯nginxé‚£äº›äº‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-å‰ç«¯nginxé‚£äº›äº‹"}},[t._v("#")]),t._v(" 5.1 å‰ç«¯Nginxé‚£äº›äº‹")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/lXoAxSVgJib309JpyfsgbGdM4Ergib06PCL6EL0wsMTWxqfsCLsAw2iahQYpo9U0Mcgk0BwUSvbUepver8RFW7K1w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("è¯¦ç»†ä¿¡æ¯è¯·çœ‹ä¹‹å‰æ¢³ç†çš„"),s("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MjM5OTExNzQ3NQ==&mid=2450958611&idx=1&sn=a4cfe928fd06e93b0da1ce2b602d6e64&chksm=b1225edf8655d7c9fc708c70445b7613f4919dac0d429f5f85d0b05c4d0c98656affd7b6d246&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‰ç«¯Nginxé‚£äº›äº‹"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"_5-2-è¡¥å……"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-è¡¥å……"}},[t._v("#")]),t._v(" 5.2 è¡¥å……")]),t._v(" "),s("ul",[s("li",[t._v("ç°åº¦å‘å¸ƒ")])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("ç°åº¦å‘å¸ƒå³æ˜¯è®©ä¸€éƒ¨åˆ†äººç»§ç»­ç”¨æ—§ç‰ˆæœ¬çš„äº§å“Aï¼Œç„¶åä¸€éƒ¨åˆ†ç”¨æˆ·å¼€å§‹ç”¨æ–°ç‰ˆæœ¬ç‰¹å¾çš„äº§å“Bï¼Œå¦‚æœç”¨æˆ·å¯¹Bæ²¡æœ‰ä»€ä¹ˆé—®é¢˜åé¦ˆï¼Œåˆ™é€æ­¥æ‰©å¤§èŒƒå›´ã€‚ä¸€æ–¹é¢å¯ä»¥ä¿è¯æ•´ä½“ç³»ç»Ÿçš„ç¨³å®šï¼Œè€Œä¸”åœ¨åˆå§‹ç°åº¦çš„æ—¶å€™å°±å¯ä»¥å‘ç°ã€è°ƒæ•´é—®é¢˜ï¼Œä»¥ä¿è¯å…¶å½±å“åº¦")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("p",[t._v("ä¼ ç»Ÿçš„ç°åº¦æ˜¯é€šè¿‡"),s("code",[t._v("Nginx")]),t._v("åˆ†å‘æµé‡åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ç®€å•çš„ç°åº¦è§„åˆ™é…ç½®ï¼Œé€šè¿‡åœ¨"),s("code",[t._v("nginx")]),t._v("é‡Œé¢é…ç½®è·¯ç”±è§„åˆ™å°±å¥½ï¼Œå¦‚æœæ˜¯è§„åˆ™å¤æ‚çš„è¯,å¯ä»¥ç»“åˆ"),s("code",[t._v("nginx+lua")]),t._v(" åšä¸€äº›äº›ç°åº¦çš„ä¸šåŠ¡é€»è¾‘")]),t._v(" "),s("p",[t._v("1.æ ¹æ®Cookieå®ç°ç°åº¦å‘å¸ƒ")]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("é€šè¿‡è·å–cookieè®¾ç½®çš„ç‰ˆæœ¬å·æ¥åŒºåˆ†")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" test1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 192.168.0.1:8080 max_fails=1 fail_timeout=60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 192.168.0.0:8080 max_fails=1 fail_timeout=60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  www.****.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"default"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_cookie")]),t._v(" ~* "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version=V1"')]),t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")]),t._v(" test1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                       \n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   Host             "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   X-Real-IP        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html index.htm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",[s("li",[t._v("æ ¹æ®IPå®ç°ç°åº¦å‘å¸ƒ")])]),t._v(" "),s("blockquote",[s("p",[t._v("â")]),t._v(" "),s("p",[t._v("é€šè¿‡å†…å¤–ç½‘IPæ¥åŒºåˆ†")]),t._v(" "),s("p",[t._v("â")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" test1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 192.168.0.1:8080 max_fails=1 fail_timeout=60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 192.168.0.0:8080 max_fails=1 fail_timeout=60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  www.xxx.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")]),t._v(" default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),t._v(" ~ "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10.0.0.110"')]),t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")]),t._v(" test1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                       \n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$group")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   Host             "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   X-Real-IP        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   X-Forwarded-For "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  index.html index.htm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);