(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{350:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"docker-webhook-ä»é›¶å®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-webhook-ä»é›¶å®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[t._v("#")]),t._v(" docker + webhook ä»é›¶å®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/_riSVxNdPsbyQf9qAoT4fQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mp.weixin.qq.com/s/_riSVxNdPsbyQf9qAoT4fQ"),s("OutboundLink")],1)])]),t._v(" "),s("blockquote",[s("p",[t._v("ä½œè€…ï¼šyeyan1996")]),t._v(" "),s("p",[t._v("https://juejin.im/post/5ef4c7eff265da230b52dfc5")])]),t._v(" "),s("h1",{attrs:{id:"å‰è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[t._v("#")]),t._v(" å‰è¨€")]),t._v(" "),s("p",[t._v("å¾—ç›Šäº node çš„æ¨ªç©ºå‡ºä¸–ä»¥åŠå‰ç«¯å·¥ç¨‹åŒ–çš„å…´èµ·ï¼Œæ— è®ºæ˜¯å¼€å‘æ¨¡å¼ï¼Œè¿˜æ˜¯å¼€å‘æ¡†æ¶ï¼Œå‰ç«¯ç”Ÿæ€é“¾éƒ½äº§ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œä¸æ­¤åŒæ—¶å‰ç«¯æ…¢æ…¢å¼€å§‹å‘å…¶ä»–é¢†åŸŸæ¢ç´¢ï¼Œé¡¹ç›®éƒ¨ç½²å°±æ˜¯å…¶ä¸­ä¸€ä¸ªé¢†åŸŸ")]),t._v(" "),s("p",[t._v("åœ¨åˆ€è€•ç«ç§çš„æ—¶ä»£ï¼Œå½“æ‰§è¡Œ "),s("code",[t._v("npm run build")]),t._v(" å°†ç”Ÿæˆäº§ç‰©äº¤ç»™è¿ç»´åï¼Œå‰ç«¯çš„ä»»åŠ¡å°±ç®—å®Œæˆäº†ï¼Œè¿ç»´åŒå­¦åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šå°†äº§ç‰©çš„è·¯å¾„å†™å…¥ nginx é…ç½®æ–‡ä»¶ï¼Œè‡³æ­¤å®Œæˆäº†â€œç®€å•â€çš„éƒ¨ç½²")]),t._v(" "),s("p",[t._v("éšç€é¡¹ç›®çš„ä¸æ–­è¿­ä»£ï¼Œå‰ç«¯å¼€å§‹å‘ç°é—®é¢˜çš„ä¸¥é‡æ€§ï¼Œæ¯æ¬¡éƒ½éœ€è¦è€—è´¹å¤§é‡çš„æ—¶é—´åœ¨æ‰“åŒ…ä¸Šï¼Œ"),s("code",[t._v("å¼€å‘5åˆ†é’Ÿï¼Œæ‰“åŒ…åŠå°æ—¶çš„æƒ…å†µå±¡è§ä¸é²œ")]),t._v("ï¼Œå¦å¤–å¼€å‘è€…è‡ªèº«ç¯å¢ƒçš„å·®å¼‚ä¼šå¯¼è‡´æœ€ç»ˆçš„äº§ç‰©ä¹Ÿæœ‰ä¸åŒ")]),t._v(" "),s("p",[t._v("ä½†åŠæ³•æ€»æ¯”å›°éš¾å¤šï¼Œä¾‹å¦‚å¯ä»¥å°†æ‰“åŒ…æ“ä½œæ”¾åˆ°è¿œç«¯æœåŠ¡å™¨ä¸Šï¼Œåˆæ¯”å¦‚å¯ä»¥å°†ä¸Šè¿°æµç¨‹ç»“åˆ git ä»“åº“å®ç°è‡ªåŠ¨éƒ¨ç½²")]),t._v(" "),s("p",[t._v("æœ¬ç€ä¸è®¾è¾¹ç•Œçš„â€œå­—èŠ‚èŒƒâ€ï¼Œæœ¬æ–‡å°†ä»é›¶å¼€å§‹ï¼Œå®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹ï¼Œæ‰“å¼€é¡¹ç›®éƒ¨ç½²çš„â€œé»‘ç›’â€")]),t._v(" "),s("p",[t._v("æ¶‰åŠæŠ€æœ¯æ ˆå¦‚ä¸‹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("docker")]),t._v(" "),s("li",[t._v("node")]),t._v(" "),s("li",[t._v("pm2")]),t._v(" "),s("li",[t._v("shell")]),t._v(" "),s("li",[t._v("webhook")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("æ–‡ç« ä¸­çš„å‘½ä»¤å¤§éƒ¨åˆ†ä¸º linux å‘½ä»¤ï¼Œæœ¬åœ°æ˜¯ windows ç³»ç»Ÿçš„è¯»è€…è¯·ä½¿ç”¨ git bash\n")])])]),s("h1",{attrs:{id:"ä»‹ç»-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»‹ç»-docker"}},[t._v("#")]),t._v(" ä»‹ç» docker")]),t._v(" "),s("p",[t._v("ç€æ‰‹å¼€å‘å‰ï¼Œå…ˆä»‹ç»è¿™æ¬¡çš„ä¸»è§’ "),s("code",[t._v("docker")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVraWmec8WEqg5I8gmbvibAcnMxvWqWWzWoAM6eyuAnYh9IYL3aeZKoNg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h2",{attrs:{id:"ä»€ä¹ˆæ˜¯-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-docker"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯ docker")]),t._v(" "),s("p",[t._v("ç®€è€Œè¨€ä¹‹ï¼Œdocker å¯ä»¥çµæ´»çš„åˆ›å»º/é”€æ¯/ç®¡ç†å¤šä¸ª"),s("code",[t._v("æœåŠ¡å™¨")]),t._v("ï¼Œè¿™äº›"),s("code",[t._v("æœåŠ¡å™¨")]),t._v("è¢«ç§°ä¸º "),s("code",[t._v("å®¹å™¨ (container)")])]),t._v(" "),s("p",[t._v("åœ¨å®¹å™¨ä¸­ä½ å¯ä»¥åšä»»ä½•æœåŠ¡å™¨å¯ä»¥åšçš„äº‹ï¼Œä¾‹å¦‚åœ¨æœ‰ node ç¯å¢ƒçš„å®¹å™¨ä¸­è¿è¡Œ "),s("code",[t._v("npm run build")]),t._v("æ‰“åŒ…é¡¹ç›®ï¼Œåœ¨æœ‰ nginx ç¯å¢ƒçš„å®¹å™¨ä¸­éƒ¨ç½²é¡¹ç›®ï¼Œåœ¨æœ‰ mysql ç¯å¢ƒçš„å®¹å™¨ä¸­åšæ•°æ®å­˜å‚¨ç­‰ç­‰")]),t._v(" "),s("p",[t._v("ä¸€æ—¦æœåŠ¡å™¨å®‰è£…äº† docker ï¼Œå°±å¯ä»¥è‡ªç”±åˆ›å»ºä»»æ„å¤šçš„å®¹å™¨ï¼Œä¸Šå›¾ä¸­ docker çš„ logo å½¢è±¡çš„å±•ç¤ºäº†å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼ŒğŸ³å°±æ˜¯ dockerï¼Œä¸Šé¢çš„ä¸€ä¸ªä¸ªé›†è£…ç®±å°±æ˜¯å®¹å™¨")]),t._v(" "),s("h2",{attrs:{id:"å®‰è£…-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-docker"}},[t._v("#")]),t._v(" å®‰è£… docker")]),t._v(" "),s("p",[t._v("ä¸ºäº†æ–¹ä¾¿æœ¬åœ°è°ƒè¯•ï¼Œå¯ä»¥å…ˆåœ¨æœ¬åœ°å®‰è£… docker")]),t._v(" "),s("p",[t._v("Macï¼šhttps://download.docker.com/mac/stable/Docker.dmg")]),t._v(" "),s("p",[t._v("Windowsï¼šhttps://download.docker.com/win/stable/Docker%20for%20Windows%20Installer.exe")]),t._v(" "),s("p",[t._v("Linuxï¼šhttps://get.docker.com/")]),t._v(" "),s("p",[t._v("ä¸‹è½½å®‰è£…å®Œæ¯•åï¼Œç‚¹å‡» docker å›¾æ ‡å¯åŠ¨ dockerï¼Œæ­¤æ—¶åœ¨ç»ˆç«¯ä¸­å°±å¯ä»¥ä½¿ç”¨ docker ç›¸å…³çš„æ“ä½œ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVLXXics7j9rzLZMgLJUklEmTZ9hYwXXOzHzQgUhnmiaznArN0jQCTNeBw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œæ£€æŸ¥ docker åº”ç”¨ç¨‹åºæ˜¯å¦æ­£å¸¸å¯åŠ¨")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" daemon running?.\n")])])]),s("h2",{attrs:{id:"åŸºæœ¬æ¦‚å¿µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬æ¦‚å¿µ"}},[t._v("#")]),t._v(" åŸºæœ¬æ¦‚å¿µ")]),t._v(" "),s("p",[t._v("docker æœ‰ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µ")]),t._v(" "),s("ul",[s("li",[t._v("é•œåƒï¼ˆimageï¼‰")]),t._v(" "),s("li",[t._v("å®¹å™¨ï¼ˆcontainerï¼‰")]),t._v(" "),s("li",[t._v("ä»“åº“ï¼ˆrepositoryï¼‰")])]),t._v(" "),s("p",[t._v("å¦‚æœæŠŠå®¹å™¨æ¯”ä½œè½»é‡çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆé•œåƒå°±æ˜¯åˆ›å»ºå®ƒçš„æ¨¡ç‰ˆï¼Œä¸€ä¸ª docker é•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼Œå®ƒä»¬çš„å…³ç³»å¥½æ¯” JavaScript ä¸­ç±»å’Œå®ä¾‹çš„å…³ç³»")]),t._v(" "),s("p",[t._v("æœ‰ä¸¤ç§æ–¹å¼è·å–é•œåƒ")]),t._v(" "),s("ul",[s("li",[t._v("Dockerfile æ–‡ä»¶åˆ›å»ºè€Œæˆ")]),t._v(" "),s("li",[t._v("ç›´æ¥ä½¿ç”¨ dockerHub æˆ–è€…å…¶ä»–ä»“åº“ä¸Šç°æœ‰çš„é•œåƒ")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVxtibBMGad36sibV5VQQib6cqWhH5Sf4OpQN3AtUzXNibenQ8kQQhtiaWljg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("blockquote",[s("p",[t._v("ä»ä»“åº“æˆ–è€…dockerfile => é•œåƒ => åˆ›å»ºå®¹å™¨")])]),t._v(" "),s("h2",{attrs:{id:"dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[t._v("#")]),t._v(" Dockerfile")]),t._v(" "),s("blockquote",[s("p",[t._v("Dockerfile æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œç±»ä¼¼ "),s("code",[t._v(".gitlab-ci.yml/package.json")]),t._v("ï¼Œå®šä¹‰äº†å¦‚ä½•ç”Ÿæˆé•œåƒ")]),t._v(" "),s("p",[t._v("å°è¯•ç”¨ Dockerfile åˆ›å»º docker é•œåƒ")])]),t._v(" "),s("h3",{attrs:{id:"åˆ›å»ºæ–‡ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºæ–‡ä»¶"}},[t._v("#")]),t._v(" åˆ›å»ºæ–‡ä»¶")]),t._v(" "),s("p",[t._v("é¦–å…ˆåˆ›å»ºä¸€ä¸ª "),s("code",[t._v("hello-docker")]),t._v(" ç›®å½•ï¼Œåœ¨ç›®å½•ä¸­åˆ›å»º "),s("code",[t._v("index.html")]),t._v(" å’Œ "),s("code",[t._v("Dockerfile")]),t._v(" æ–‡ä»¶")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--index.html--\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Hello docker"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Dockerfile")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" nginx")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" index.html /usr/share/nginx/html/index.html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 80")]),t._v("\n")])])]),s("ul",[s("li",[t._v("FROM nginxï¼šåŸºäºå®˜æ–¹ nginx é•œåƒ")]),t._v(" "),s("li",[t._v("COPY index.html /usr/share/nginx/html/index.htmlï¼š"),s("strong",[t._v("å°†å½“å‰ç›®å½•ä¸‹ index.html æ›¿æ¢å®¹å™¨ä¸­ /usr/share/nginx/html/index.html æ–‡ä»¶ï¼Œ "),s("code",[t._v("/usr/share/nginx/html")]),t._v(" æ˜¯å®¹å™¨ä¸­ nginx é»˜è®¤å­˜æ”¾ç½‘é¡µæ–‡ä»¶çš„ç›®å½•ï¼Œè®¿é—®å®¹å™¨ 80 ç«¯å£ä¼šå±•ç¤ºè¯¥ç›®å½•ä¸‹ index.html æ–‡ä»¶")])]),t._v(" "),s("li",[t._v("EXPOSE 80ï¼šå®¹å™¨å¯¹å¤–æš´éœ² 80 ç«¯å£ï¼Œä¸»è¦èµ·å£°æ˜ä½œç”¨ï¼ŒçœŸå®ç«¯å£æ˜ å°„è¿˜éœ€è¦åœ¨åˆ›å»ºå®¹å™¨æ—¶å®šä¹‰")])]),t._v(" "),s("p",[t._v("å…¶ä»– Dockerfile é…ç½®å‚è€ƒå®˜æ–¹æ–‡æ¡£")]),t._v(" "),s("p",[t._v("æ­¤æ—¶ï¼Œä½ çš„æ–‡ä»¶ç»“æ„åº”è¯¥æ˜¯")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("hello-docker\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("____index.html\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("____Dockerfile\n")])])]),s("h3",{attrs:{id:"åˆ›å»ºé•œåƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºé•œåƒ"}},[t._v("#")]),t._v(" åˆ›å»ºé•œåƒ")]),t._v(" "),s("p",[t._v("åœ¨åˆ›å»º Dockerfile æ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ª docker é•œåƒ")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--pull")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" test-image:latest\n")])])]),s("ul",[s("li",[s("code",[t._v("build")]),t._v("ï¼šåˆ›å»º docker é•œåƒ")]),t._v(" "),s("li",[s("code",[t._v("â€”pull")]),t._v(": ä½¿ç¼“å­˜å¤±æ•ˆ")]),t._v(" "),s("li",[s("code",[t._v(".")]),t._v("ï¼šä½¿ç”¨å½“å‰ç›®å½•ä¸‹çš„ dockerfile æ–‡ä»¶")]),t._v(" "),s("li",[s("code",[t._v("-t")]),t._v("ï¼šä½¿ç”¨ tag æ ‡è®°ç‰ˆæœ¬")]),t._v(" "),s("li",[s("code",[t._v("test-image:latest")]),t._v("ï¼šåˆ›å»ºåä¸º "),s("code",[t._v("test-image")]),t._v(" çš„é•œåƒï¼Œå¹¶æ ‡è®°ä¸º latestï¼ˆæœ€æ–°ï¼‰ç‰ˆæœ¬")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVqCVpyuNg2jvggo3ka5J1NibS4u1zd1QYtBb3b6ZiaUwEuETGM8SR3RQw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("é€šè¿‡ "),s("code",[t._v("docker images")]),t._v(" å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰é•œåƒ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVibY7YLWHmL19rjL1z9ug2xL6J9zOiauQLPZkejKqiafVXmn0RQ24QBDKw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h3",{attrs:{id:"åˆ›å»ºå®¹å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå®¹å™¨"}},[t._v("#")]),t._v(" åˆ›å»ºå®¹å™¨")]),t._v(" "),s("p",[t._v("é•œåƒæˆåŠŸåˆ›å»ºåï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ª docker å®¹å™¨")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" test-container test-image:latest\n")])])]),s("ul",[s("li",[t._v("runï¼šåˆ›å»ºå¹¶è¿è¡Œ docker å®¹å™¨")]),t._v(" "),s("li",[t._v("-dï¼šåå°è¿è¡Œå®¹å™¨")]),t._v(" "),s("li",[t._v("80:80ï¼šå°†å½“å‰æœåŠ¡å™¨çš„ 80 ç«¯å£ï¼ˆå†’å·å‰çš„ 80ï¼‰ï¼Œæ˜ å°„åˆ°å®¹å™¨çš„ 80 ç«¯å£ï¼ˆå†’å·åçš„ 80ï¼‰")]),t._v(" "),s("li",[t._v("--nameï¼šç»™å®¹å™¨å‘½åï¼Œä¾¿äºä¹‹åå®šä½å®¹å™¨")]),t._v(" "),s("li",[t._v("test-image:latestï¼šåŸºäº "),s("code",[t._v("test-image")]),t._v(" æœ€æ–°ç‰ˆæœ¬çš„é•œåƒåˆ›å»ºå®¹å™¨")])]),t._v(" "),s("p",[t._v("é€šè¿‡ "),s("code",[t._v("docker ps -a")]),t._v(" å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å®¹å™¨")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVdmgQOqZWjJb2UgibyuwxkFyf6jMCus4nGIzRjck3twW2qPGKY6lZxxQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ç”±äºæœ¬åœ° 80 ç«¯å£æ˜ å°„åˆ°äº†å®¹å™¨çš„ 80 ç«¯å£ï¼Œæ‰€ä»¥å½“è¾“å…¥ "),s("code",[t._v("localhost")]),t._v(" æ—¶ï¼Œä¼šæ˜¾ç¤º index.html æ–‡ä»¶å†…å®¹")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVFJNMJHHEnxITJGa24nqzUPWpAC4ulxLBdEA2m6e5Ou3EzAR7e4jibmw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h2",{attrs:{id:"dockerhub"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerhub"}},[t._v("#")]),t._v(" dockerHub")]),t._v(" "),s("p",[t._v("å¦‚æœè¯´ github æ˜¯å­˜å‚¨ä»£ç çš„ä»“åº“ï¼Œé‚£ä¹ˆ dockerhub å°±æ˜¯å­˜å‚¨é•œåƒçš„ä»“åº“")]),t._v(" "),s("p",[t._v("å¼€å‘è€…å¯ä»¥å°† Dockerfile ç”Ÿæˆçš„é•œåƒä¸Šä¼ åˆ° dockerhub æ¥å­˜å‚¨è‡ªå®šä¹‰é•œåƒï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„é•œåƒ")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull nginx\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("81")]),t._v(":80  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" nginx-container nginx\n")])])]),s("p",[t._v("ç¬¬ä¸€æ­¥æ‹‰å–äº†å®˜æ–¹çš„ nginx é•œåƒï¼Œç¬¬äºŒæ­¥ç”¨åŸºäºå®˜æ–¹ nginx é•œåƒåˆ›å»ºåä¸º "),s("code",[t._v("nginx-container")]),t._v(" çš„å®¹å™¨")]),t._v(" "),s("p",[t._v("ç”±äºä¸Šä¸€æ­¥æ“ä½œæœ¬åœ° 80 ç«¯å£å·²ç»è¢«å ç”¨äº†ï¼Œè¿™é‡Œä½¿ç”¨ 81 ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ 80 ç«¯å£ï¼Œè®¿é—® "),s("code",[t._v("localhost:81")]),t._v(" å¯ä»¥çœ‹åˆ° nginx å¯åŠ¨é¡µé¢")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVf00mAdaKCgxDQ55iaUCm1lRibAfXbqsvYlF9B5Eg9m1jm44LOUPSOg6w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h2",{attrs:{id:"ä¸ºä»€ä¹ˆè¦ç”¨-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦ç”¨-docker"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦ç”¨ docker")]),t._v(" "),s("p",[t._v("äº†è§£äº† docker çš„æ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•ï¼Œæ¥ç€è®²è®²ä¸ºä»€ä¹ˆè¦ç”¨ docker")]),t._v(" "),s("p",[t._v("æœ‰äººä¼šé—®ï¼Œç¯å¢ƒæˆ‘éƒ½å¯ä»¥è£…åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œä¸ºä»€ä¹ˆè¿˜è¦æ”¾åœ¨ä¸€ä¸ªä¸ªå®¹å™¨é‡Œå‘¢ï¼Ÿè¿™é‡Œåˆ—ä¸¾ä½¿ç”¨ docker çš„å‡ ä¸ªä¼˜ç‚¹")]),t._v(" "),s("h3",{attrs:{id:"ç¯å¢ƒç»Ÿä¸€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒç»Ÿä¸€"}},[t._v("#")]),t._v(" ç¯å¢ƒç»Ÿä¸€")]),t._v(" "),s("p",[t._v("docker çš„å‡ºç°è§£å†³äº†ä¸€ä¸ªä¸–çºªéš¾é¢˜ï¼š"),s("code",[t._v("åœ¨æˆ‘ç”µè„‘ä¸Šæ˜æ˜æ˜¯å¥½çš„")]),t._v(" ğŸ˜ƒ")]),t._v(" "),s("p",[t._v("å¼€å‘è€…å¯ä»¥å°†å¼€å‘ç¯å¢ƒç”¨ docker é•œåƒä¸Šä¼ åˆ° docker ä»“åº“ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæ‹‰å–å¹¶è¿è¡Œç›¸åŒçš„é•œåƒï¼Œä¿æŒç¯å¢ƒä¸€è‡´")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" push yeyan1996/docker-test-image:latest\n")])])]),s("p",[t._v("æœ¬åœ°æäº¤åä¸º "),s("code",[t._v("docker-test-image")]),t._v(" çš„é•œåƒï¼Œé•œåƒåéœ€è¦åŠ ä¸Š dockerhub è´¦å·ä½œä¸ºå‰ç¼€")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull yeyan1996/docker-test-image:latest\n")])])]),s("p",[t._v("æœåŠ¡å™¨æ‹‰å–è´¦å· "),s("code",[t._v("yeyan1996")]),t._v(" ä¸‹çš„ "),s("code",[t._v("docker-test-image")]),t._v(" é•œåƒ")]),t._v(" "),s("h3",{attrs:{id:"ä¾¿äºå›æ»š"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¾¿äºå›æ»š"}},[t._v("#")]),t._v(" ä¾¿äºå›æ»š")]),t._v(" "),s("p",[t._v("ç±»ä¼¼ "),s("code",[t._v("git")]),t._v("ï¼Œ"),s("code",[t._v("docker")]),t._v(" ä¹Ÿæœ‰ç‰ˆæœ¬æ§åˆ¶")]),t._v(" "),s("p",[t._v("åœ¨åˆ›å»ºé•œåƒæ—¶å¯ä»¥ä½¿ç”¨ "),s("code",[t._v("tag")]),t._v(" æ ‡è®°ç‰ˆæœ¬ï¼Œå¦‚æœæŸä¸ªç‰ˆæœ¬çš„ç¯å¢ƒæœ‰é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šåˆ°ä¹‹å‰ç‰ˆæœ¬")]),t._v(" "),s("h3",{attrs:{id:"ç¯å¢ƒéš”ç¦»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒéš”ç¦»"}},[t._v("#")]),t._v(" ç¯å¢ƒéš”ç¦»")]),t._v(" "),s("p",[t._v("ä½¿ç”¨ docker å¯ä»¥ä½¿ä½ çš„æœåŠ¡å™¨æ›´å¹²å‡€ï¼Œæ„å»ºç”¨åˆ°çš„ç¯å¢ƒå¯ä»¥éƒ½æ”¾åœ¨å®¹å™¨ä¸­")]),t._v(" "),s("h3",{attrs:{id:"é«˜æ•ˆå¹¶èŠ‚çœèµ„æº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é«˜æ•ˆå¹¶èŠ‚çœèµ„æº"}},[t._v("#")]),t._v(" é«˜æ•ˆå¹¶èŠ‚çœèµ„æº")]),t._v(" "),s("p",[t._v("ç›¸æ¯”äºçœŸå®æœåŠ¡å™¨/è™šæ‹Ÿæœºï¼Œå®¹å™¨ä¸åŒ…å«æ“ä½œç³»ç»Ÿï¼Œè¿™æ„å‘³ç€åˆ›å»º/é”€æ¯å®¹å™¨éƒ½ååˆ†é«˜æ•ˆ")]),t._v(" "),s("h1",{attrs:{id:"å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[t._v("#")]),t._v(" å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("p",[t._v("ä»‹ç»å®Œ dockerï¼Œæ¥ç€æˆ‘ä»¬ä»é›¶å¼€å§‹å®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("p",[t._v("åœ¨æ²¡è¿ç§» Docker ä¹‹å‰ï¼Œè‹¥æˆ‘æƒ³æ›´æ–°çº¿ä¸Šç½‘ç«™ä¸­å†…å®¹æ—¶ï¼Œéœ€è¦ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æœ¬åœ°è¿è¡Œ "),s("code",[t._v("npm run build")]),t._v(" ç”Ÿæˆæ„å»ºäº§ç‰©")]),t._v(" "),s("li",[t._v("å°†äº§ç‰©é€šè¿‡ ftp ç­‰å½¢å¼ä¸Šä¼ åˆ°æœåŠ¡å™¨")]),t._v(" "),s("li",[s("code",[t._v("git push")]),t._v(" æäº¤ä»£ç åˆ°ä»“åº“")])]),t._v(" "),s("p",[t._v("åœ¨å®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²åï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("git push")]),t._v(" æäº¤ä»£ç åˆ°ä»“åº“")]),t._v(" "),s("li",[t._v("æœåŠ¡å™¨è‡ªåŠ¨æ›´æ–°é•œåƒ")]),t._v(" "),s("li",[t._v("é•œåƒä¸­è‡ªåŠ¨è¿è¡Œ "),s("code",[t._v("npm run build")]),t._v(" ç”Ÿæˆæ„å»ºäº§ç‰©")]),t._v(" "),s("li",[t._v("æœåŠ¡å™¨è‡ªåŠ¨åˆ›å»ºå®¹å™¨")])]),t._v(" "),s("p",[t._v("å¯ä»¥å‘ç°ï¼Œå®ç°å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²åå¼€å‘è€…éœ€è¦åšçš„åªæ˜¯æŠŠä»£ç æ¨åˆ°ä»“åº“ï¼Œå…¶ä½™çš„äº‹éƒ½å¯ä»¥é€šè¿‡æœåŠ¡å™¨ä¸Šçš„è‡ªåŠ¨åŒ–è„šæœ¬å®Œæˆ")]),t._v(" "),s("h1",{attrs:{id:"äº‘æœåŠ¡å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº‘æœåŠ¡å™¨"}},[t._v("#")]),t._v(" äº‘æœåŠ¡å™¨")]),t._v(" "),s("p",[t._v("é¦–å…ˆä½ å¾—æœ‰ä¸€å°æœåŠ¡å™¨å§-ã€‚-")]),t._v(" "),s("p",[t._v("ç”±äºæ˜¯ä¸ªäººé¡¹ç›®ï¼Œå¯¹äº‘æœåŠ¡å™¨çš„è¦æ±‚ä¸é«˜ï¼Œå¤§éƒ¨åˆ†ä¾›åº”å•†ä¼šç»™æ–°ç”¨æˆ·ç™½å«–å…è´¹è¯•ç”¨ 1-2 å‘¨ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©è…¾è®¯äº‘ "),s("code",[t._v("CentOS 7.6 64ä½")]),t._v(" çš„æ“ä½œç³»ç»Ÿï¼Œå½“ç„¶é˜¿é‡Œäº‘æˆ–å…¶ä»–äº‘æœåŠ¡å™¨ä¹Ÿå®Œå…¨ ok")]),t._v(" "),s("h2",{attrs:{id:"ç™»é™†äº‘æœåŠ¡å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç™»é™†äº‘æœåŠ¡å™¨"}},[t._v("#")]),t._v(" ç™»é™†äº‘æœåŠ¡å™¨")]),t._v(" "),s("blockquote",[s("p",[t._v("ç†Ÿæ‚‰äº‘æœåŠ¡å™¨é…ç½®æˆ–è€…ä¸æ˜¯è…¾è®¯äº‘çš„è¯»è€…å¯ä»¥è·³è¿‡è¿™ç« ")])]),t._v(" "),s("p",[t._v("æ³¨å†Œç›¸å…³çš„æ“ä½œä¸ç»†è¯´äº†ï¼Œå‚è€ƒä¾›åº”å•†æ•™ç¨‹ï¼Œéšåç™»é™†æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å½“å‰äº‘æœåŠ¡å™¨çš„å…¬ç½‘ IPï¼Œä¾‹å¦‚ä¸‹å›¾ä¸­æœåŠ¡å™¨çš„å…¬ç½‘ IP æ˜¯ï¼š118.89.244.45")]),t._v(" "),s("p",[t._v("å…¬ç½‘ IP ç”¨äºä¹‹å webhook å‘é€è¯·æ±‚çš„åœ°å€")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVy39uDcoicjf9EgbH4LrDpKPTJgqlGBGIKZVnBHiauRBKibMwa8UbE74icw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ç„¶åæˆ‘ä»¬éœ€è¦ç™»é™†äº‘æœåŠ¡å™¨ï¼Œæœ¬åœ°ç™»é™†äº‘æœåŠ¡å™¨çš„æ–¹å¼ä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œå¯†ç ç™»é™†å’Œ ssh ç™»é™†ï¼ˆæˆ–è€…ç”¨ ssh å·¥å…·ï¼Œwindows ç³»ç»Ÿå¯ä»¥ç”¨ xhellï¼ŒmacOS å¯ä»¥ç”¨ puttyï¼‰")]),t._v(" "),s("p",[t._v("å‰è€…æ— éœ€é…ç½®ï¼Œä½†æ¯æ¬¡ç™»é™†éƒ½éœ€è¦è¾“å…¥è´¦å·å¯†ç ï¼Œåè€…éœ€è¦æ³¨å†Œ ssh å¯†é’¥ï¼Œä½†ä¹‹åå¯ä»¥å…å¯†ç™»é™†äº‘æœåŠ¡å™¨ã€‚ä¸ªäººæ¯”è¾ƒå–œæ¬¢åè€…ï¼Œæ‰€ä»¥å…ˆåœ¨æ§åˆ¶å°æ³¨å†Œ ssh å¯†é’¥"),s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xV5WlDN0kZtYG3OqBl5oCAticQ8UQH1QvdI8FdpA2bSv66ARXFFOEME4A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ç”Ÿæˆå¯†é’¥çš„æ–¹å¼åŒ gitï¼Œä¹‹å‰ç”Ÿæˆè¿‡çš„è¯æœ¬åœ°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°±èƒ½æŸ¥çœ‹")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("less")]),t._v(" ~/.ssh/id_rsa.pub\n")])])]),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVibCiaJiblMrIWfVpbB8e4OZFM3IsOWPD7YHCIM2pAw95ENS7ng7e4MAkQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("æ²¡æœ‰ç”Ÿæˆè¿‡å¯†é’¥æœ¬åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼Œå‚è€ƒ æœåŠ¡å™¨ä¸Šçš„ Git - ç”Ÿæˆ SSH å…¬é’¥")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v("\nGenerating public/private rsa key pair.\nEnter "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" to save the key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/home/schacon/.ssh/id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\nCreated directory "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/schacon/.ssh'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nEnter passphrase "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("empty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" no passphrase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\nEnter same passphrase again:\nYour identification has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /home/schacon/.ssh/id_rsa.\nYour public key has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /home/schacon/.ssh/id_rsa.pub.\nThe key fingerprint is:\nd0:82:24:8e:d7:f1:bb:9b:33:53:96:93:49:da:9b:e3 schacon@mylaptop.local\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" ~/.ssh/id_rsa.pub\nssh-rsa AAAAB3NzaCxxxxxxxxxxxxxxxxxxxxxxxxBWDSU\nGPl+nafzlHDTYxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxPppSwg0cda3\nPbv7kOdJ/MxxxxxxxxxxxxxxxxxxxxxxxxxxxQwdsdMFvSlVK/7XA\nt3FaoJoxxxxxxxxxxxxxxxxxxxxx88XypNDvjYNby6vw/Pb0rwert/En\nmZ+AW4OZPnTxxxxxxxxxxxxxxxxxxo1d01QraTlMqVSsbx\nNrRFi9wrf+M7Q"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" schacon@mylaptop.local\n")])])]),s("p",[t._v("å°†ç”Ÿæˆçš„å…¬é’¥æ”¾åœ¨äº‘æœåŠ¡å™¨æ§åˆ¶å°å›¾ç¤ºéƒ¨åˆ†ï¼Œç‚¹å‡»ç¡®å®š")]),t._v(" "),s("p",[t._v("é™¤äº†æ³¨å†Œå…¬é’¥ï¼Œè¿˜éœ€è¦å°†å®ƒç»‘å®šå®ä¾‹ï¼Œå°†"),s("code",[t._v("å®ä¾‹å…³æœºå¹¶è¿›è¡Œç»‘å®š")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xV45dn4OGnQ2FHdXGKn7cs9x8ia82aiatQZ39vRFUZlLTJax6qaKKd1YNQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ç»‘å®šå®Œæˆåé‡æ–°å¼€æœºï¼Œè‡³æ­¤å°±å¯ä»¥åœ¨æœ¬åœ°é€šè¿‡ ssh å‘½ä»¤ç™»é™†äº‘æœåŠ¡å™¨å•¦")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("hostname or IP address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVJQonlfe4PQszgQoqfuJGt59E5udw8wwJ3SWCIg7vpIyZeImbLtVYcg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h2",{attrs:{id:"å®‰è£…ç¯å¢ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…ç¯å¢ƒ"}},[t._v("#")]),t._v(" å®‰è£…ç¯å¢ƒ")]),t._v(" "),s("p",[t._v("æ¥ç€ç»™äº‘æœåŠ¡å™¨å®‰è£…åŸºç¡€çš„ç¯å¢ƒ")]),t._v(" "),s("h3",{attrs:{id:"docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[t._v("#")]),t._v(" docker")]),t._v(" "),s("p",[t._v("ä¹‹å‰åœ¨æœ¬åœ°å®‰è£…äº† dockerï¼Œä½†äº‘æœåŠ¡å™¨ä¸Šé»˜è®¤ä¹Ÿæ˜¯æ²¡æœ‰çš„ï¼Œæ‰€ä»¥éœ€è¦ç»™å®ƒä¹Ÿå®‰è£… docker ç¯å¢ƒ")]),t._v(" "),s("p",[t._v("äº‘æœåŠ¡å™¨å®‰è£…å’Œæœ¬åœ°æœ‰äº›åŒºåˆ«ï¼Œæ ¹æ® docker å®˜ç½‘ çš„å®‰è£…æ•™ç¨‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Step 1: å®‰è£…å¿…è¦çš„ä¸€äº›ç³»ç»Ÿå·¥å…·")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" yum-utils\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Step 2: æ·»åŠ è½¯ä»¶æºä¿¡æ¯ï¼Œä½¿ç”¨é˜¿é‡Œäº‘é•œåƒ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Step 3: å®‰è£… docker-ce")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" docker-ce docker-ce-cli containerd.io\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Step 4: å¼€å¯ dockeræœåŠ¡")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Step 5: è¿è¡Œ hello-world é¡¹ç›®")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run hello-world\n")])])]),s("p",[t._v("å¼¹å‡º "),s("code",[t._v("Hello from Docker!")]),t._v(" è¯æ˜ Docker å·²ç»æˆåŠŸå®‰è£…å•¦ï½")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVle5UibtFTJ9CWiczCibfNh99ukNolgZEOxibw50kXkp6bpc07Z3ReElq7Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h3",{attrs:{id:"git"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git"}},[t._v("#")]),t._v(" git")]),t._v(" "),s("p",[t._v("è‡ªåŠ¨åŒ–éƒ¨ç½²æ¶‰åŠåˆ°æ‹‰å–æœ€æ–°çš„ä»£ç ï¼Œæ‰€ä»¥éœ€è¦å®‰è£… git ç¯å¢ƒ")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v("\n")])])]),s("p",[t._v("ç”±äº SSH æ–¹å¼è¿˜éœ€è¦åœ¨ github ä¸Šæ³¨å†Œå…¬é’¥ï¼Œæ–¹ä¾¿èµ·è§ï¼Œä¹‹åä¼šé€‰æ‹© HTTPS çš„æ–¹å¼å…‹éš†ä»“åº“")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVBnaUWNeRwnjE3MX9XX2qcWXuNtS5xmHvRlibicN2LqMUic7DbIOrsFzTg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h3",{attrs:{id:"node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node"}},[t._v("#")]),t._v(" node")]),t._v(" "),s("p",[t._v("æ—¢ç„¶æ˜¯å‰ç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œäº‘æœåŠ¡å™¨ä¸Šç›¸å…³å¤„ç†é€»è¾‘ç”¨ js ç¼–å†™ï¼Œæ‰€ä»¥éœ€è¦å®‰è£… node ç¯å¢ƒï¼Œè¿™é‡Œç”¨ nvm æ¥ç®¡ç† node ç‰ˆæœ¬")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),s("p",[t._v("æ¥ç€éœ€è¦å°† nvm ä½œä¸ºç¯å¢ƒå˜é‡")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NVM_DIR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v('/.nvm"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/nvm.sh"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/nvm.sh"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# This loads nvm[ -s "$NVM_DIR/bash_completion" ] && \\. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion')]),t._v("\n")])])]),s("p",[t._v("é€šè¿‡ nvm å®‰è£…æœ€æ–°ç‰ˆ node")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nvm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v("\n")])])]),s("p",[t._v("node å®‰è£…å®Œæˆåï¼Œè¿˜éœ€è¦å®‰è£… "),s("code",[t._v("pm2")]),t._v("ï¼Œå®ƒèƒ½ä½¿ä½ çš„ js è„šæœ¬èƒ½åœ¨äº‘æœåŠ¡å™¨çš„åå°è¿è¡Œ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xV4szK9RaoDjcvKq7HDTPHP5Bkhr1NXQv89UuzNCrA4PLjmYxokgicWaQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i pm2 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v("\n")])])]),s("h1",{attrs:{id:"åˆ›å»º-demo-é¡¹ç›®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-demo-é¡¹ç›®"}},[t._v("#")]),t._v(" åˆ›å»º demo é¡¹ç›®")]),t._v(" "),s("p",[t._v("ç®€å•ä½¿ç”¨ vue-cli åœ¨æœ¬åœ°åˆ›å»ºé¡¹ç›®")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("vue create docker-test\n")])])]),s("p",[t._v("å¹¶å°† demo é¡¹ç›®ä¸Šä¼ åˆ° githubï¼Œå‡†å¤‡é…ç½® webhook")]),t._v(" "),s("h1",{attrs:{id:"webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webhook"}},[t._v("#")]),t._v(" webhook")]),t._v(" "),s("p",[t._v("hook ç¿»è¯‘ä¸º"),s("code",[t._v("é’©å­")]),t._v("ï¼Œè¿˜å¯ä»¥ç†è§£ä¸º"),s("code",[t._v("å›è°ƒ")])]),t._v(" "),s("p",[t._v("å‚è€ƒ Vue ç”Ÿå‘½å‘¨æœŸï¼Œå½“ç»„ä»¶æŒ‚è½½å®Œæˆæ—¶ä¼šè§¦å‘ mounted é’©å­ï¼Œåœ¨é’©å­ä¸­å¯ä»¥ç¼–å†™æ‹‰å–åç«¯æ•°æ®ï¼Œæˆ–è€…æ¸²æŸ“é¡µé¢ç­‰å›è°ƒé€»è¾‘")]),t._v(" "),s("blockquote",[s("p",[t._v("github çš„ webhook ä¼šåœ¨å½“å‰ä»“åº“è§¦å‘æŸäº›äº‹ä»¶æ—¶ï¼Œå‘é€ä¸€ä¸ª post å½¢å¼çš„ http è¯·æ±‚")]),t._v(" "),s("p",[t._v("å½“ä»“åº“æœ‰æäº¤ä»£ç æ—¶ï¼Œé€šè¿‡å°† webhook è¯·æ±‚åœ°å€æŒ‡å‘äº‘æœåŠ¡å™¨ IP åœ°å€ï¼Œäº‘æœåŠ¡å™¨å°±èƒ½çŸ¥é“é¡¹ç›®æœ‰æ›´æ–°ï¼Œä¹‹åè¿è¡Œç›¸å…³ä»£ç å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²")])]),t._v(" "),s("h2",{attrs:{id:"é…ç½®-webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-webhook"}},[t._v("#")]),t._v(" é…ç½® webhook")]),t._v(" "),s("p",[t._v("æ‰“å¼€ github çš„ä»“åº“ä¸»é¡µï¼Œç‚¹å‡»å³ä¾§ settings")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVxRYJPcQibRef7sMfpyHMBIcP905n7Ckp85nuunutWQT0UHiaQUPx3yrQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xV2GXvgicRftp74m2508dtzsve5jrPlibwQXusOC3CyOGcPvibGib3BsMlag/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("ul",[s("li",[t._v("Payload URLï¼šå¡«å†™äº‘æœåŠ¡å™¨å…¬ç½‘ IPï¼Œè®°å¾—æ·»åŠ  http(s) å‰ç¼€")]),t._v(" "),s("li",[t._v("Content typeï¼šé€‰æ‹© application/json å³å‘é€ json æ ¼å¼çš„ post è¯·æ±‚")]),t._v(" "),s("li",[t._v("è§¦å‘æ—¶æœºï¼šJust the push eventï¼Œå³ä»“åº“ push äº‹ä»¶ï¼Œæ ¹æ®ä¸åŒçš„éœ€æ±‚è¿˜å¯ä»¥é€‰æ‹©å…¶ä»–äº‹ä»¶ï¼Œä¾‹å¦‚ PRï¼Œæäº¤ Commitï¼Œæäº¤ issues ç­‰")])]),t._v(" "),s("p",[t._v("webhook è¿˜å¯ä»¥è®¾ç½®ä¸€äº›é‰´æƒç›¸å…³çš„ tokenï¼Œç”±äºæ˜¯ä¸ªäººé¡¹ç›®è¿™é‡Œä¸è¯¦ç»†å±•å¼€äº†")]),t._v(" "),s("p",[t._v("ç‚¹å‡» "),s("code",[t._v("Add webhook")]),t._v(" ä¸ºå½“å‰é¡¹ç›®æ·»åŠ ä¸€ä¸ª webhookï¼Œè‡³æ­¤ï¼Œå½“ "),s("code",[t._v("docker-test")]),t._v(" é¡¹ç›®æœ‰ä»£ç æäº¤æ—¶ï¼Œå°±ä¼šå¾€ "),s("code",[t._v("http://118.89.244.45:3000")]),t._v(" å‘é€ä¸€ä¸ª post è¯·æ±‚")]),t._v(" "),s("h2",{attrs:{id:"æµ‹è¯•-webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•-webhook"}},[t._v("#")]),t._v(" æµ‹è¯• webhook")]),t._v(" "),s("p",[t._v("é…ç½®å®Œæˆåï¼Œå¯ä»¥å‘ä»“åº“æäº¤ä¸€ä¸ª commitï¼Œç„¶åç‚¹å‡»æœ€ä¸‹æ–¹å¯ä»¥çœ‹åˆ° post è¯·æ±‚å‚æ•°")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVety1zxA1tDBzCF8s7H9ica17FCkWoDxTlfeCicaLpia4ECPJuAMfSAFHg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å‚æ•°ä¸»è¦æ¶‰åŠå½“å‰ä»“åº“å’Œæœ¬åœ°æäº¤çš„ä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä»¬åªç”¨ "),s("code",[t._v("repository.name")]),t._v(" è·å–æ›´æ–°çš„ä»“åº“åå³å¯")]),t._v(" "),s("h1",{attrs:{id:"å¤„ç†é¡¹ç›®æ›´æ–°çš„è¯·æ±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¤„ç†é¡¹ç›®æ›´æ–°çš„è¯·æ±‚"}},[t._v("#")]),t._v(" å¤„ç†é¡¹ç›®æ›´æ–°çš„è¯·æ±‚")]),t._v(" "),s("p",[t._v("å½“äº‘æœåŠ¡å™¨æ¥æ”¶åˆ°é¡¹ç›®æ›´æ–°åå‘é€çš„ post è¯·æ±‚åï¼Œéœ€è¦åˆ›å»º/æ›´æ–°é•œåƒæ¥å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²")]),t._v(" "),s("h2",{attrs:{id:"åˆ›å»º-dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-dockerfile"}},[t._v("#")]),t._v(" åˆ›å»º Dockerfile")]),t._v(" "),s("p",[t._v("å…ˆåœ¨æœ¬åœ°é¡¹ç›®é‡Œæ–°å»ºä¸€ä¸ª Dockerfile ç”¨äºä¹‹ååˆ›å»ºé•œåƒ")]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dockerfile")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# build stage")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" node:lts-alpine "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" build-stage")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /app")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" package*.json ./")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm install")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" . .")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" npm run build")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# production stage")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" nginx:stable-alpine "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" production-stage")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token options"}},[s("span",{pre:!0,attrs:{class:"token property"}},[t._v("--from")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("build-stage")])]),t._v(" /app/dist /usr/share/nginx/html")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 80")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CMD")]),t._v(" ["),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nginx"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-g"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"daemon off;"')]),t._v("]")]),t._v("\n")])])]),s("p",[t._v("é€è¡Œè§£æé…ç½®ï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("FROM node:lts-alpine as build-stage")]),t._v("ï¼šåŸºäº node  "),s("code",[t._v("lts-alpine")]),t._v(" ç‰ˆæœ¬é•œåƒï¼Œå¹¶é€šè¿‡æ„å»ºé˜¶æ®µå‘½åï¼Œå°†æœ‰ node ç¯å¢ƒçš„é˜¶æ®µå‘½åä¸º "),s("code",[t._v("build-stage")]),t._v("ï¼ˆåŒ…å« alpine çš„é•œåƒç‰ˆæœ¬ç›¸æ¯”äº latest ç‰ˆæœ¬æ›´åŠ å°å·§ï¼Œæ›´é€‚åˆä½œä¸º docker é•œåƒä½¿ç”¨ï¼‰")]),t._v(" "),s("li",[s("code",[t._v("WORKDIR /app")]),t._v("ï¼šå°†å·¥ä½œåŒºè®¾ä¸º /appï¼Œå’Œå…¶ä»–ç³»ç»Ÿæ–‡ä»¶éš”ç¦»")]),t._v(" "),s("li",[s("code",[t._v("COPY package*.json ./")]),t._v("ï¼šæ‹·è´"),s("code",[t._v("package.json/package-lock.json")]),t._v(" åˆ°å®¹å™¨çš„ /app ç›®å½•")]),t._v(" "),s("li",[s("code",[t._v("RUN npm install")]),t._v("ï¼šè¿è¡Œ "),s("code",[t._v("npm install")]),t._v(" åœ¨å®¹å™¨ä¸­å®‰è£…ä¾èµ–")]),t._v(" "),s("li",[s("code",[t._v("COPY . .")]),t._v("ï¼šæ‹·è´å…¶ä»–æ–‡ä»¶åˆ°å®¹å™¨ /app ç›®å½•ï¼Œåˆ†ä¸¤æ¬¡æ‹·è´æ˜¯å› ä¸ºä¿æŒ "),s("code",[t._v("node_modules")]),t._v("ä¸€è‡´")]),t._v(" "),s("li",[s("code",[t._v("RUN npm run build")]),t._v("ï¼šè¿è¡Œ "),s("code",[t._v("npm run build")]),t._v(" åœ¨å®¹å™¨ä¸­æ„å»º")])]),t._v(" "),s("p",[t._v("è¿™é‡Œç”¨åˆ°äº† docker ä¸€ä¸ªæŠ€å·§ï¼šå¤šé˜¶æ®µæ„å»º")]),t._v(" "),s("p",[t._v("å°†æ„å»ºåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µåŸºäº node é•œåƒï¼Œç¬¬äºŒé˜¶æ®µåŸºäº nginx é•œåƒ")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("FROM nginx:lts-alpine as production-stage")]),t._v("ï¼šåŸºäº nginx  "),s("code",[t._v("stable-alpine")]),t._v(" ç‰ˆæœ¬é•œåƒï¼Œå¹¶å°†æœ‰ nginx ç¯å¢ƒçš„é˜¶æ®µå‘½åä¸º "),s("code",[t._v("production-stage")])]),t._v(" "),s("li",[s("code",[t._v("COPY --from=build-stage /app/dist /usr/share/nginx/html")]),t._v("ï¼šé€šè¿‡ --form å‚æ•°å¯ä»¥"),s("strong",[t._v("å¼•ç”¨ "),s("code",[t._v("build-stage")]),t._v(" é˜¶æ®µç”Ÿæˆçš„äº§ç‰©")]),t._v("ï¼Œå°†å…¶å¤åˆ¶åˆ° "),s("code",[t._v("/usr/share/nginx/html")])]),t._v(" "),s("li",[s("code",[t._v("EXPOSE 80")]),t._v("ï¼šå®¹å™¨å¯¹å¤–æš´éœ² 80 ç«¯å£")]),t._v(" "),s("li",[s("code",[t._v('CMD ["nginx", "-g", "daemon off;"]')]),t._v("ï¼šå®¹å™¨åˆ›å»ºæ—¶è¿è¡Œ "),s("code",[t._v("nginx -g daemon off")]),t._v(" å‘½ä»¤ï¼Œ"),s("code",[t._v("ä¸€æ—¦ CMD å¯¹åº”çš„å‘½ä»¤ç»“æŸï¼Œå®¹å™¨å°±ä¼šè¢«é”€æ¯")]),t._v("ï¼Œæ‰€ä»¥é€šè¿‡"),s("code",[t._v("daemon off è®© nginx")]),t._v(" ä¸€ç›´åœ¨å‰å°è¿è¡Œ")])]),t._v(" "),s("p",[t._v("æœ€åé€šè¿‡ "),s("code",[t._v("scp")]),t._v(" å‘½ä»¤ï¼Œå°† Dockerfile æ–‡ä»¶å¤åˆ¶åˆ°äº‘æœåŠ¡å™¨ä¸Š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("scp ./Dockerfile root@118.89.244.45:/root\n")])])]),s("h2",{attrs:{id:"åˆ›å»º-dockerignore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-dockerignore"}},[t._v("#")]),t._v(" åˆ›å»º .dockerignore")]),t._v(" "),s("p",[t._v("ç±»ä¼¼"),s("code",[t._v(".gitignore")]),t._v("ï¼Œ"),s("code",[t._v(".dockerignore")]),t._v("å¯ä»¥åœ¨åˆ›å»ºé•œåƒå¤åˆ¶æ–‡ä»¶æ—¶å¿½ç•¥å¤åˆ¶æŸäº›æ–‡ä»¶")]),t._v(" "),s("p",[t._v("æœ¬åœ°é¡¹ç›®é‡Œæ–°å»º .dockerignore")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .dockerignore")]),t._v("\nnode_modules\n")])])]),s("p",[t._v("ç”±äºéœ€è¦"),s("strong",[t._v("ä¿æŒæœ¬åœ°å’Œå®¹å™¨ä¸­ node_module ä¾èµ–åŒ…ä¸€è‡´")]),t._v("ï¼Œåœ¨åˆ›å»º Dockerfile æ—¶ç”¨äº†ä¸¤æ¬¡ "),s("code",[t._v("COPY")]),t._v(" å‘½ä»¤")]),t._v(" "),s("p",[t._v("ç¬¬ä¸€æ¬¡åªå¤åˆ¶ "),s("code",[t._v("package.json")]),t._v(" å’Œ "),s("code",[t._v("package-lock.json")]),t._v("ï¼Œå¹¶å®‰è£…ä¾èµ–")]),t._v(" "),s("p",[t._v("ç¬¬äºŒæ¬¡å¤åˆ¶"),s("strong",[t._v("é™¤ node_modules")]),t._v("çš„æ‰€æœ‰æ–‡ä»¶")]),t._v(" "),s("p",[t._v("æ¥ç€å°†"),s("code",[t._v(".dockerignore")]),t._v(" æ–‡ä»¶ä¹Ÿå¤åˆ¶åˆ°äº‘æœåŠ¡å™¨ä¸Š")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" ./.dockerignore root@118.89.244.45:/root\n")])])]),s("h2",{attrs:{id:"åˆ›å»º-http-æœåŠ¡å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-http-æœåŠ¡å™¨"}},[t._v("#")]),t._v(" åˆ›å»º http æœåŠ¡å™¨")]),t._v(" "),s("p",[t._v("ç”±äºæˆ‘ä»¬æ˜¯å‰ç«¯å¼€å‘ï¼Œè¿™é‡Œä½¿ç”¨ node å¼€å¯ä¸€ä¸ªç®€å•çš„ http æœåŠ¡å™¨å¤„ç† webhook å‘é€çš„ post è¯·æ±‚")]),t._v(" "),s("p",[t._v("æœ¬åœ°é¡¹ç›®é‡Œæ–°å»º index.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'receive request'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server is ready'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"æ‹‰å–ä»“åº“ä»£ç "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‹‰å–ä»“åº“ä»£ç "}},[t._v("#")]),t._v(" æ‹‰å–ä»“åº“ä»£ç ")]),t._v(" "),s("p",[t._v("å½“é¡¹ç›®æ›´æ–°åï¼Œäº‘æœåŠ¡å™¨éœ€è¦å…ˆæ‹‰å–ä»“åº“æœ€æ–°ä»£ç ")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("execSync"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"child_process"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€’å½’åˆ é™¤ç›®å½•")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("existsSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" curPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("statSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDirectory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// recurse")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// delete file")]),t._v("\n                fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlinkSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rmdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("resolvePost")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" chunk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            chunk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"end"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'receive request'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolvePost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" projectDir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("./")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‹‰å–ä»“åº“æœ€æ–°ä»£ç ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("git clone https://github.com/yeyan1996/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(".git ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stdio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server is ready'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("data.repository.name")]),t._v(" å³ webhook ä¸­è®°å½•ä»“åº“åçš„å±æ€§")]),t._v(" "),s("h2",{attrs:{id:"åˆ›å»ºé•œåƒå’Œå®¹å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºé•œåƒå’Œå®¹å™¨"}},[t._v("#")]),t._v(" åˆ›å»ºé•œåƒå’Œå®¹å™¨")]),t._v(" "),s("p",[t._v("åœ¨åˆ›å»ºæ–°å®¹å™¨å‰ï¼Œéœ€è¦å…ˆæŠŠæ—§å®¹å™¨é”€æ¯ï¼Œè¿™é‡Œå…ˆä»‹ç»å‡ ä¸ªç”¨åˆ°çš„ docker å‘½ä»¤ï¼š")]),t._v(" "),s("p",[t._v("æŸ¥çœ‹æ‰€æœ‰ name ä»¥ docker å¼€å¤´çš„ docker å®¹å™¨ï¼Œå¹¶åªè¾“å‡ºå®¹å™¨å")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name=^docker"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--format")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{{.Names}}"')]),t._v("\n")])])]),s("p",[t._v("åœæ­¢ name ä¸º docker-container çš„å®¹å™¨")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" stop docker-container\n")])])]),s("p",[t._v("åˆ é™¤ name ä¸º docker-container çš„å®¹å™¨ï¼ˆåœæ­¢çŠ¶æ€çš„å®¹å™¨æ‰èƒ½è¢«åˆ é™¤ï¼‰")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" docker-container\n")])])]),s("p",[t._v("ç„¶åç»™ index.js æ·»åŠ  docker ç›¸å…³é€»è¾‘")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" execSync "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€’å½’åˆ é™¤ç›®å½•")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("existsSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" curPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("statSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDirectory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// recurse")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// delete file")]),t._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlinkSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("curPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rmdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("resolvePost")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" chunk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      chunk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'receive request'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolvePost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" projectDir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("./")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteFolderRecursive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‹‰å–ä»“åº“æœ€æ–°ä»£ç ")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("git clone https://github.com/yeyan1996/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(".git ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stdio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤åˆ¶ Dockerfile åˆ°é¡¹ç›®ç›®å½•")]),t._v("\n      fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("copyFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("./Dockerfile")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./Dockerfile'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤åˆ¶ .dockerignore åˆ°é¡¹ç›®ç›®å½•")]),t._v("\n      fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("copyFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("./.dockerignore")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("projectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./.dockerignore'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»º docker é•œåƒ")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("docker build . -t ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("-image:latest ")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stdio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cwd")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" projectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é”€æ¯ docker å®¹å™¨")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('docker ps -a -f "name=^')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('-container" --format="{{.Names}}" | xargs -r docker stop | xargs -r docker rm')]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stdio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»º docker å®¹å™¨")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("docker run -d -p 8888:80 --name ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("-container  ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("-image:latest")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stdio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deploy success'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server is ready'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("åœ¨é”€æ¯ docker å®¹å™¨éƒ¨åˆ†ç”¨åˆ°äº† linux çš„ç®¡é“è¿ç®—ç¬¦å’Œ "),s("code",[t._v("xargs")]),t._v(" å‘½ä»¤ï¼Œè¿‡æ»¤å‡ºä»¥"),s("code",[t._v("docker-test")]),t._v(" å¼€å¤´å®¹å™¨ï¼ˆç”¨ "),s("code",[t._v("docker-test")]),t._v(" ä»“åº“çš„ä»£ç åˆ¶ä½œçš„é•œåƒåˆ›å»ºçš„å®¹å™¨ï¼‰ï¼Œåœæ­¢ï¼Œåˆ é™¤å¹¶é‡æ–°åˆ›å»ºå®ƒä»¬")]),t._v(" "),s("p",[t._v("åŒæ ·é€šè¿‡ scp å¤åˆ¶åˆ°äº‘æœåŠ¡å™¨ä¸Š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("scp ./index.js root@118.89.244.45:/root\n")])])]),s("h2",{attrs:{id:"è¿è¡Œ-node-è„šæœ¬"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¿è¡Œ-node-è„šæœ¬"}},[t._v("#")]),t._v(" è¿è¡Œ node è„šæœ¬")]),t._v(" "),s("p",[t._v("é€šè¿‡ä¹‹å‰å®‰è£…çš„ pm2 å°† index.js ä½œä¸ºåå°è„šæœ¬åœ¨äº‘æœåŠ¡å™¨ä¸Šè¿è¡Œ")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("pm2 start index.js\n")])])]),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVXYaeCRN58nvoCwMZOXBZkBictbC6CiaVh4aVsBXsrcLTDSabzfCZjnRQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®äº‘æœåŠ¡å™¨ 8888 ç«¯å£çœ‹åˆ°éƒ¨ç½²çš„ demo é¡¹ç›®ï¼ˆè®¿é—®å‰ç¡®ä¿æœåŠ¡å™¨å·²å¼€æ”¾ 8888 ç«¯å£ï¼‰")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVfdmANXzkcaNnvM39U7ULBfJdHYaAL0QHvfcVsIo5r42GsicvIzB4sMw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("h1",{attrs:{id:"try-it"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#try-it"}},[t._v("#")]),t._v(" try it")]),t._v(" "),s("p",[t._v("æ¥è¯•è¯•è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æµç¨‹æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œ")]),t._v(" "),s("p",[t._v("é¦–å…ˆåœ¨äº‘æœåŠ¡å™¨ä¸Šè¿è¡Œ "),s("code",[t._v("pm2 logs")]),t._v(" æŸ¥çœ‹ index.js è¾“å‡ºçš„æ—¥å¿—ï¼Œéšåæœ¬åœ°æ·»åŠ  "),s("code",[t._v("hello docker")]),t._v(" æ–‡æ¡ˆï¼Œå¹¶æ¨é€è‡³ github"),s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVnRxl3H8ScJknal7yIamsQSR1tibRryudvufoeTn7Qia0WV8sjBtoG37w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ä¸å‡ºæ„å¤–ï¼Œpm2 ä¼šè¾“å‡ºå…‹éš†é¡¹ç›®çš„æ—¥å¿—")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVSvXyUOGHsmXiciawYcMm4rq0hD237g4ickTJKnqE0YvxOgQe5n4ygW2iag/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å…‹éš†å®Œæ¯•åå°† Dockerfile å’Œ .dockerignore æ”¾å…¥é¡¹ç›®æ–‡ä»¶ä¸­ï¼Œå¹¶æ›´æ–°é•œåƒ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVB9XM4lLdvFj7ia0WTSDKe2PiawM71GpWdMx2k3JIRU2V5m1Qsy3nr1rg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}}),t._v("æ¥ç€é”€æ¯æ—§å®¹å™¨ï¼Œå¹¶ä½¿ç”¨æ›´æ–°åçš„é•œåƒåˆ›å»ºå®¹å™¨")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVpmyA0rgYnSOL8TWiamH8ibIMjZIcgOgqjY4lr9bVPAYEohTHMb6KbVow/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("æœ€åè®¿é—® 8888 ç«¯å£å¯ä»¥çœ‹åˆ°æ›´æ–°åçš„æ–‡æ¡ˆ"),s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVuiaP8XKCV3p89GEmlwwhibA2ibEzxNevzJRDbyun2wNnsKfwaKsvCIDOg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å¤§åŠŸå‘Šæˆï½")]),t._v(" "),s("h1",{attrs:{id:"æºç "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æºç "}},[t._v("#")]),t._v(" æºç ")]),t._v(" "),s("p",[t._v("Docker-test")]),t._v(" "),s("p",[t._v("å…³æ³¨ Dockerfile ï¼Œ.dockerignoreï¼Œ index.js æ–‡ä»¶")]),t._v(" "),s("h1",{attrs:{id:"å†™åœ¨åé¢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†™åœ¨åé¢"}},[t._v("#")]),t._v(" å†™åœ¨åé¢")]),t._v(" "),s("p",[t._v("ä¸Šè¿° demo åªåˆ›å»ºäº†å•ä¸ª docker å®¹å™¨ï¼Œå½“é¡¹ç›®æ›´æ–°æ—¶ï¼Œç”±äºå®¹å™¨éœ€è¦ç»è¿‡é”€æ¯å’Œåˆ›å»ºçš„è¿‡ç¨‹ï¼Œä¼šå­˜åœ¨ä¸€æ®µæ—¶é—´é¡µé¢æ— æ³•è®¿é—®æƒ…å†µ")]),t._v(" "),s("p",[t._v("è€Œå®é™…æŠ•å…¥ç”Ÿäº§æ—¶ä¸€èˆ¬ä¼šåˆ›å»ºå¤šä¸ªå®¹å™¨ï¼Œå¹¶é€æ­¥æ›´æ–°æ¯ä¸ªå®¹å™¨ï¼Œé…åˆè´Ÿè½½å‡è¡¡å°†ç”¨æˆ·çš„è¯·æ±‚æ˜ å°„åˆ°ä¸åŒç«¯å£çš„å®¹å™¨ä¸Šï¼Œç¡®ä¿çº¿ä¸Šçš„æœåŠ¡ä¸ä¼šå› ä¸ºå®¹å™¨çš„æ›´æ–°è€Œå®•æœº")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVu9Or8cDCVAicibDFT4piaHqOvRrVF9sgMYmmuxXAsicdqRmEQ9XEiaG1kicA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("å¦å¤–åŸºäº github å¹³å°ä¹Ÿæœ‰éå¸¸æˆç†Ÿçš„ CI/CD å·¥å…·ï¼Œä¾‹å¦‚")]),t._v(" "),s("ul",[s("li",[t._v("travis-ci")]),t._v(" "),s("li",[t._v("circleci")])]),t._v(" "),s("p",[t._v("é€šè¿‡ yml é…ç½®æ–‡ä»¶ï¼Œç®€åŒ–ä¸Šæ–‡ä¸­æ³¨å†Œ webhook å’Œç¼–å†™æ›´æ–°å®¹å™¨çš„ index.js è„šæœ¬çš„æ­¥éª¤")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .travis.yml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node_js")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branchs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("only")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("directories")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node_modules\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn install\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scripts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn test\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn build\n")])])]),s("p",[t._v("å¦å¤–éšç€ç¯å¢ƒçš„å¢å¤šï¼Œå®¹å™¨ä¹Ÿä¼šé€æ¸å¢åŠ ï¼Œdocker ä¹Ÿæ¨å‡ºäº†æ›´å¥½ç®¡ç†å¤šä¸ªå®¹å™¨çš„æ–¹å¼  docker-compose")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/C94aicOicyXpJ0xrLbuaTM5S1LQoffm4xVdEicUqDUDFjkVqickjCEybJfpVzABWNB3yHzl0yRuKpibgG6pdWHAU7Ag/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),s("p",[t._v("ä½†æœ¬æ–‡çš„å®—æ—¨è¿˜æ˜¯æ¢ç´¢å…¶ä¸­çš„åŸç†ï¼Œç»´æŠ¤æˆç†Ÿçš„å¼€æºé¡¹ç›®è¿˜æ˜¯æ¨èä½¿ç”¨ä¸Šè¿°å¹³å°")]),t._v(" "),s("p",[t._v("æ„Ÿè°¢ä½ èƒ½çœ‹åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ï½")])])}),[],!1,null,null,null);s.default=e.exports}}]);